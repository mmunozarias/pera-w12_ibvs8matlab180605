function u = phIBVS( q, qdot, tau )
% phIBVS   Generate the control torque based on 
%          port-Hamiltonian IBVS controller
% 
% pH-based IBVS for the PERA
%   u = bG^(-1) (C1 + C2 - C3 - C4 - C5)
% where
%   bG = T^{-1} G,
%   C1 = \bar{T}^{-1} \pd{\bar{H}}{\bar{q}}^T,
%   C2 = (\bar{J}_{22} - \bar{D} - C) \bar{T}^T \bar{\Delta}^+ \bar{\tau},
%   C3 = (\pd{\theta}{\bar{q}} + \pd{\theta}{\bar{\tau}} \bar{\Delta})
%        \bar{T}^{-T} \bar{p},
%   C4 = C \bar{p},
%   C5 = \bar{T}^{-1} \bar{\Delta}^T \bar{\tau}
%   *\pd{f}{x} menas partial derivative of f wrt x

phy_param;     % load some kinds of phsical parameters
contr_param;   % load (kf, taud) and (kp, kd, ki)

M = geneM_w12( q );
p = M*qdot;

%T = chol( M, 'lower' );
T = zeros(2, 2);  T(1,1) = sqrt(M(1,1));  T(2,2) = sqrt(M(2,2));
%[q', det( T )]   % for debug
invT = inv( T );
pbar = invT*p;

G = eye(2);
Gbar = T'*G;

%Kp = 1*kp*eye(2); no need for pH IBVS
Kt = 1*[
    1, 0, 0;
    0, 1, 0;
];
ferr = tau - taud;   % original


%% Case A: take dl2 into account
%dVdq = [ g*m2*(dcl2*cos(q(1)) + acl2*sin(q(1))*cos(q(2))), ...
%                            g*m2*acl2*cos(q(1))*sin(q(2)) ];
%% Case B: ignore dl2 (i.e., dcl2 = 0)
dVdq = [ g*m2*acl2*sin(q(1))*cos(q(2)), ...
         g*m2*acl2*cos(q(1))*sin(q(2)) ];

%% C1 = \bar{T}^{-1} \tpPDE{\bar{H}}{\bar{q}} = ... = T^{-1} \tpPDE{V}{q}
C1 = invT*dVdq'

Jbar22 = zeros(2, 2);
Jbar22(1,2) = ...
    (m2*acl2^2*sin(q(2))*cos(q(2))*p(1))...
    *(I1 + I2 + m2*(acl2*cos(q(2)))^2)^(-0.3e1/0.2e1)...
    *(m2*acl2^2 + I2)^(-0.1e1/0.2e1);
Jbar22(2,1) = -Jbar22(1,2);

D = eye(2);
D(1,1) = 0;   % currently ignore matrix D,...
D(2,2) = 0;   %   but should be like Eq.(67)
Dbar = invT*D*invT';
C = eye(2);   % should be positive-definite

Delta = image_jacobian( tau );
T_b2c = [
    rot_b2c(q), zeros(3,3);
    zeros(3,3), rot_b2c(q);
];
Jgb = geom_jacobian( q );
Jgc = T_b2c*Jgb;
Delta_tau = Delta*Jgc;

%% C2 = (\bar{J}_{22} - \bar{D} - C) \bar{T}^T \bar{\Delta}^+ \bar{\tau}
%    = ...
%    = (\bar{J}_{22} - T^{-1} D T^{-T} - C) T^T \Delta_{\tau}^+ (\tau - \taud)
%  where
%    \bar{J}_{22} = \pd{T^{-1} p}{q} T^{-T} - T^{-1} \pd{T^{-1} p}{q}^T
C2 = (Jbar22 - Dbar -C)*T'*pinv(Delta_tau)*ferr

df1dq1 = 0;
df2dq1 = 0;
df1dq2 = (L * tau(2) * (m2 * acl2^2 + I1 + I2) * cos(q(2)) + sin(q(2)) * (I1 + I2) * (L * tau(1) + acl2 * tau(3))) * f * (acl2^2 * tau(3)^4 + (0.2e1 * L * acl2 * tau(1) - acl2^2 * taud(3)) * tau(3)^3 + (L^2 * tau(2)^2 + tau(1) * ((L^2 + acl2^2) * tau(1) - 0.2e1 * L * taud(3) * acl2 - acl2^2 * taud(1))) * tau(3)^2 - ((L * taud(3) + acl2 * taud(1) - 0.2e1 * acl2 * tau(1)) * tau(2)^2 + tau(1) * taud(2) * acl2 * tau(2) - 0.2e1 * acl2 * tau(1)^3 + (L * taud(3) + 0.2e1 * acl2 * taud(1)) * tau(1)^2 - f^2 * acl2 * tau(1) + f^2 * acl2 * taud(1)) * L * tau(3) + (tau(2)^2 - taud(2) * tau(2) + tau(1) * (tau(1) - taud(1))) * L^2 * (f^2 + tau(1)^2 + tau(2)^2)) * L * (I1 + I2 + m2 * acl2^2 * cos(q(2))^2)^(-0.1e1 / 0.2e1) / (acl2^2 * tau(3)^4 + 0.2e1 * L * acl2 * tau(1) * tau(3)^3 + (L^2 * tau(2)^2 + tau(1)^2 * (L^2 + acl2^2)) * tau(3)^2 + 0.2e1 * L * tau(1) * acl2 * (f^2 + tau(1)^2 + tau(2)^2) * tau(3) + L^2 * (f^2 + tau(1)^2 + tau(2)^2)^2) / ((L^2 * tau(1)^2 - L^2 * tau(2)^2 + 0.2e1 * L * acl2 * tau(1) * tau(3) + acl2^2 * tau(3)^2) * cos(q(2))^2 - 0.2e1 * L * tau(2) * sin(q(2)) * (L * tau(1) + acl2 * tau(3)) * cos(q(2)) + L^2 * tau(2)^2);
df2dq2 = (L * tau(2) * (m2 * acl2^2 + I1 + I2) * cos(q(2)) + sin(q(2)) * (I1 + I2) * (L * tau(1) + acl2 * tau(3))) * f * (acl2^2 * tau(3)^4 + (0.2e1 * L * acl2 * tau(1) - acl2^2 * taud(3)) * tau(3)^3 + (L^2 * tau(2)^2 + tau(1) * ((L^2 + acl2^2) * tau(1) - 0.2e1 * L * taud(3) * acl2 - acl2^2 * taud(1))) * tau(3)^2 - ((L * taud(3) + acl2 * taud(1) - 0.2e1 * acl2 * tau(1)) * tau(2)^2 + tau(1) * taud(2) * acl2 * tau(2) - 0.2e1 * acl2 * tau(1)^3 + (L * taud(3) + 0.2e1 * acl2 * taud(1)) * tau(1)^2 - f^2 * acl2 * tau(1) + f^2 * acl2 * taud(1)) * L * tau(3) + (tau(2)^2 - taud(2) * tau(2) + tau(1) * (tau(1) - taud(1))) * L^2 * (f^2 + tau(1)^2 + tau(2)^2)) * L * (I1 + I2 + m2 * acl2^2 * cos(q(2))^2)^(-0.1e1 / 0.2e1) / (acl2^2 * tau(3)^4 + 0.2e1 * L * acl2 * tau(1) * tau(3)^3 + (L^2 * tau(2)^2 + tau(1)^2 * (L^2 + acl2^2)) * tau(3)^2 + 0.2e1 * L * tau(1) * acl2 * (f^2 + tau(1)^2 + tau(2)^2) * tau(3) + L^2 * (f^2 + tau(1)^2 + tau(2)^2)^2) / ((L^2 * tau(1)^2 - L^2 * tau(2)^2 + 0.2e1 * L * acl2 * tau(1) * tau(3) + acl2^2 * tau(3)^2) * cos(q(2))^2 - 0.2e1 * L * tau(2) * sin(q(2)) * (L * tau(1) + acl2 * tau(3)) * cos(q(2)) + L^2 * tau(2)^2);
dfdq = [ df1dq1, df1dq2;
         df2dq1, df2dq2 ];
df1dtau1 = -f * sqrt(I1 + I2 + m2 * acl2^2 * cos(q(2))^2) * (((((tau(1)^2 + tau(2)^2)^2 * tau(3)^4) - taud(3) * ((tau(1)^2 + tau(2)^2)^2) * (tau(3)^3) + ((2 * tau(1)^6 + (3 * f^2 - taud(2) * tau(2) + 6 * tau(2)^2) * tau(1)^4 - 2 * tau(1)^3 * f^2 * taud(1) + (-f^4 - 3 * taud(2) * tau(2) * f^2 + 6 * f^2 * tau(2)^2 - 2 * taud(2) * tau(2)^3 + 6 * tau(2)^4) * tau(1)^2 - tau(2)^2 * (f^2 + tau(2)^2) * (-f^2 + taud(2) * tau(2) - 2 * tau(2)^2)) * tau(3)^2) - 0.3e1 * ((tau(1)^4) + (0.4e1 / 0.3e1 * (tau(2)^2) - (f^2) / 0.3e1) * (tau(1)^2) + (tau(2)^4) / 0.3e1 + (f^2 * tau(2)^2) / 0.3e1) * (f^2 + tau(1)^2 + tau(2)^2) * taud(3) * tau(3) + ((tau(1)^4 - 2 * taud(1) * tau(1)^3 + (-f^2 - 3 * taud(2) * tau(2) + 2 * tau(2)^2) * tau(1)^2 - tau(2) * (f^2 + tau(2)^2) * (taud(2) - tau(2))) * (f^2 + tau(1)^2 + tau(2)^2)^2)) * L^5 + 0.4e1 * (((tau(1)^2 + tau(2)^2) * tau(3)^4) - taud(3) * (tau(1)^2 + tau(2)^2) * (tau(3)^3) + ((2 * tau(1)^4) + (taud(1) * tau(1)^3) / 0.4e1 + (0.5e1 / 0.2e1 * (f^2) + (4 * tau(2)^2) - (taud(2) * tau(2)) / 0.2e1) * (tau(1)^2) - (taud(1) * (6 * f^2 + tau(2)^2) * tau(1)) / 0.4e1 + (2 * tau(2)^4) - (taud(2) * tau(2)^3) + (2 * f^2 * tau(2)^2) - (f^4) / 0.2e1 - 0.3e1 / 0.2e1 * taud(2) * tau(2) * (f^2)) * (tau(3)^2) - 0.7e1 / 0.2e1 * ((tau(1)^4) + (0.10e2 / 0.7e1 * (tau(2)^2) + 0.4e1 / 0.7e1 * (f^2)) * (tau(1)^2) + 0.3e1 / 0.7e1 * (tau(2)^4) + 0.2e1 / 0.7e1 * (f^2) * (tau(2)^2) - (f^4) / 0.7e1) * taud(3) * tau(3) + ((tau(1)^4) - 0.9e1 / 0.4e1 * taud(1) * (tau(1)^3) + (-0.5e1 / 0.2e1 * taud(2) * tau(2) + (2 * tau(2)^2) - (f^2) / 0.2e1) * (tau(1)^2) - 0.5e1 / 0.4e1 * taud(1) * (f^2 + tau(2)^2) * tau(1) - 0.3e1 / 0.2e1 * ((taud(2) * tau(2)) - 0.2e1 / 0.3e1 * (tau(2)^2) + (f^2) / 0.3e1) * (f^2 + tau(2)^2)) * (f^2 + tau(1)^2 + tau(2)^2)) * tau(1) * tau(3) * acl2 * L^4 + 0.6e1 * (((tau(1)^2) + (tau(2)^2) / 0.3e1) * (tau(3)^4) - ((tau(1)^2) + (tau(2)^2) / 0.3e1) * taud(3) * (tau(3)^3) + ((2 * tau(1)^4) + 0.2e1 / 0.3e1 * taud(1) * (tau(1)^3) + ((2 * f^2) + 0.7e1 / 0.3e1 * (tau(2)^2)) * (tau(1)^2) - (taud(1) * (3 * f^2 + tau(2)^2) * tau(1)) / 0.3e1 + (tau(2)^4) / 0.3e1 - (taud(2) * tau(2)^3) / 0.3e1 + (f^2 * tau(2)^2) / 0.3e1 - (f^4) / 0.6e1 - (taud(2) * tau(2) * f^2) / 0.2e1) * (tau(3)^2) - 0.13e2 / 0.3e1 * ((tau(1)^4) + (0.21e2 / 0.26e2 * (tau(2)^2) + 0.6e1 / 0.13e2 * (f^2)) * (tau(1)^2) + (tau(2)^4) / 0.26e2 - (f^4) / 0.26e2) * taud(3) * tau(3) + (tau(1)^6) - 0.8e1 / 0.3e1 * (tau(1)^5) * taud(1) - (2 * tau(2) * (taud(2) - tau(2)) * tau(1)^4) - (3 * taud(1) * (f^2 + tau(2)^2) * tau(1)^3) - 0.11e2 / 0.6e1 * ((taud(2) * tau(2)) - 0.6e1 / 0.11e2 * (tau(2)^2) + 0.5e1 / 0.11e2 * (f^2)) * (f^2 + tau(2)^2) * (tau(1)^2) - 0.2e1 / 0.3e1 * taud(1) * ((f^2 + tau(2)^2)^2) * tau(1) - ((f^2 + tau(2)^2)^2 * (f^2 + taud(2) * tau(2))) / 0.6e1) * (tau(3)^2) * acl2^2 * L^3 + 0.4e1 * (tau(3)^3) * acl2^3 * ((tau(1) * tau(3)^4) - tau(1) * taud(3) * (tau(3)^3) + ((2 * tau(1)^3) + 0.3e1 / 0.2e1 * (tau(1)^2) * taud(1) + ((tau(2)^2) + 0.3e1 / 0.2e1 * (f^2) + (taud(2) * tau(2)) / 0.2e1) * tau(1) - (taud(1) * (2 * f^2 + tau(2)^2)) / 0.4e1) * (tau(3)^2) - 0.6e1 * ((tau(1)^2) + 0.5e1 / 0.12e2 * (tau(2)^2) + (f^2) / 0.3e1) * tau(1) * taud(3) * tau(3) + (tau(1)^5) - 0.7e1 / 0.2e1 * (tau(1)^4) * taud(1) + (-0.3e1 / 0.2e1 * taud(2) * tau(2) + (tau(2)^2) - (f^2) / 0.2e1) * (tau(1)^3) - 0.5e1 / 0.2e1 * taud(1) * (f^2 + tau(2)^2) * (tau(1)^2) - ((f^2 + tau(2)^2) * (f^2 + taud(2) * tau(2)) * tau(1)) / 0.2e1 - (taud(1) * (f^2 + tau(2)^2)^2) / 0.4e1) * L^2 + (tau(3)^4) * acl2^4 * ((tau(3)^4) - taud(3) * (tau(3)^3) + ((f^2 + 4 * tau(1) * taud(1) + 2 * tau(1)^2 + taud(2) * tau(2)) * tau(3)^2) - 0.11e2 * ((tau(1)^2) + 0.2e1 / 0.11e2 * (tau(2)^2) + 0.2e1 / 0.11e2 * (f^2)) * taud(3) * tau(3) + (tau(1) * (tau(1)^3 - 6 * tau(1)^2 * taud(1) + (-f^2 - taud(2) * tau(2)) * tau(1) - 2 * taud(1) * (f^2 + tau(2)^2)))) * L - acl2^5 * (tau(3)^5) * ((tau(1)^2 * taud(1)) - (tau(3)^2 * taud(1)) + 0.2e1 * taud(3) * tau(3) * tau(1))) * cos(q(2)) + ((((-tau(1)^4 * taud(1) + (f^2 * taud(1) - 2 * tau(2)^2 * taud(1)) * tau(1)^2 + (2 * f^4 + 2 * taud(2) * tau(2) * f^2) * tau(1) - tau(2)^2 * taud(1) * (f^2 + tau(2)^2)) * tau(3)^2) + 0.2e1 * tau(1) * taud(3) * (f^2 + tau(1)^2 + tau(2)^2) * (-f^2 + tau(1)^2 + tau(2)^2) * tau(3) + ((tau(1)^2 * taud(1) + (2 * f^2 + 2 * taud(2) * tau(2)) * tau(1) - taud(1) * (f^2 + tau(2)^2)) * (f^2 + tau(1)^2 + tau(2)^2)^2)) * L^4 + 0.4e1 * tau(3) * acl2 * ((-(taud(1) * tau(1)^3) + (-(f^2) / 0.4e1 - (taud(2) * tau(2)) / 0.4e1) * (tau(1)^2) + (-(tau(2)^2 * taud(1)) / 0.2e1 + (f^2 * taud(1)) / 0.2e1) * tau(1) + ((2 * f^2 + tau(2)^2) * (f^2 + taud(2) * tau(2))) / 0.4e1) * (tau(3)^2) + 0.2e1 * ((tau(1)^4) + ((tau(2)^2) + (f^2) / 0.4e1) * (tau(1)^2) - (f^2 * tau(2)^2) / 0.4e1 - (f^4) / 0.4e1) * taud(3) * tau(3) + (f^2 + tau(1)^2 + tau(2)^2) * ((taud(1) * tau(1)^3) + (0.5e1 / 0.4e1 * taud(2) * tau(2) + 0.5e1 / 0.4e1 * (f^2)) * (tau(1)^2) + ((f^2 + tau(2)^2) * (f^2 + taud(2) * tau(2))) / 0.4e1)) * L^3 + 0.6e1 * (tau(3)^2) * acl2^2 * ((-(tau(1)^2 * taud(1)) + (-(taud(2) * tau(2)) / 0.3e1 - (f^2) / 0.3e1) * tau(1) + (f^2 * taud(1)) / 0.6e1) * (tau(3)^2) + 0.2e1 * tau(1) * ((tau(1)^2) + (tau(2)^2) / 0.2e1 + (f^2) / 0.3e1) * taud(3) * tau(3) + ((tau(1)^2) + (tau(2)^2) / 0.2e1 + (f^2) / 0.2e1) * ((tau(1)^2 * taud(1)) + (0.2e1 / 0.3e1 * taud(2) * tau(2) + 0.2e1 / 0.3e1 * (f^2)) * tau(1) + (taud(1) * (f^2 + tau(2)^2)) / 0.3e1)) * L^2 + 0.4e1 * ((-(tau(1) * taud(1)) - (taud(2) * tau(2)) / 0.4e1 - (f^2) / 0.4e1) * (tau(3)^2) + 0.2e1 * ((tau(1)^2) + (tau(2)^2) / 0.4e1 + (f^2) / 0.4e1) * taud(3) * tau(3) + tau(1) * ((tau(1)^2 * taud(1)) + ((taud(2) * tau(2)) / 0.4e1 + (f^2) / 0.4e1) * tau(1) + (taud(1) * (f^2 + tau(2)^2)) / 0.2e1)) * (tau(3)^3) * acl2^3 * L + acl2^4 * (tau(3)^4) * ((tau(1)^2 * taud(1)) - (tau(3)^2 * taud(1)) + 0.2e1 * taud(3) * tau(3) * tau(1))) * tau(2) * sin(q(2)) * L) * L / (((tau(1)^2 + tau(2)^2) * tau(3)^2 + (f^2 + tau(1)^2 + tau(2)^2)^2) * L^2 + 0.2e1 * acl2 * tau(3) * tau(1) * (f^2 + tau(1)^2 + tau(2)^2 + tau(3)^2) * L + acl2^2 * (tau(3)^2) * (tau(1)^2 + tau(3)^2))^2 / (((tau(1)^2 - tau(2)^2) * L^2 + 0.2e1 * L * acl2 * tau(1) * tau(3) + acl2^2 * (tau(3)^2)) * cos(q(2))^2 - 0.2e1 * L * tau(2) * sin(q(2)) * (L * tau(1) + acl2 * tau(3)) * cos(q(2)) + L^2 * (tau(2)^2));
df2dtau1 = (((((taud(2) * tau(2)^4 + 2 * taud(1) * tau(1) * tau(2)^3 - 2 * taud(2) * tau(1)^2 * tau(2)^2 + (-4 * f^2 * tau(1)^2 - 2 * taud(1) * tau(1)^3) * tau(2) + taud(2) * tau(1)^4) * tau(3)^4) + (4 * tau(2) * taud(3) * f^2 * tau(1)^2 * tau(3)^3) + ((2 * taud(2) * tau(2)^6) + (4 * taud(1) * tau(1) * tau(2)^5) + ((4 * taud(2) * f^2 - 2 * taud(2) * tau(1)^2) * tau(2)^4) + 0.6e1 * (taud(1) - 0.4e1 / 0.3e1 * tau(1)) * tau(1) * (f^2) * (tau(2)^3) + (2 * taud(2) * (f^4 - 2 * f^2 * tau(1)^2 - tau(1)^4) * tau(2)^2) + (2 * tau(1) * (f^4 * taud(1) - 6 * f^4 * tau(1) - 3 * f^2 * taud(1) * tau(1)^2 - 4 * f^2 * tau(1)^3 - 2 * tau(1)^4 * taud(1)) * tau(2)) + (2 * taud(2) * tau(1)^2 * (f^2 + tau(1)^2)^2)) * (tau(3)^2) + (8 * tau(2) * taud(3) * f^2 * tau(1)^2 * (f^2 + tau(1)^2 + tau(2)^2) * tau(3)) + ((taud(2) * tau(2)^4 + 2 * taud(1) * tau(1) * tau(2)^3 + (2 * taud(2) * f^2 - 2 * taud(2) * tau(1)^2) * tau(2)^2 + (2 * f^2 * taud(1) * tau(1) - 4 * f^2 * tau(1)^2 - 2 * taud(1) * tau(1)^3) * tau(2) + taud(2) * (f^2 + tau(1)^2)^2) * (f^2 + tau(1)^2 + tau(2)^2)^2)) * L^5 + 0.4e1 * acl2 * tau(3) * (((tau(2)^3 * taud(1)) / 0.2e1 - (taud(2) * tau(2)^2 * tau(1)) + (-(2 * f^2 * tau(1)) - 0.3e1 / 0.2e1 * (tau(1)^2) * taud(1)) * tau(2) + (taud(2) * tau(1)^3)) * (tau(3)^4) + (tau(2) * taud(3) * tau(1) * (4 * f^2 - tau(1)^2 + tau(2)^2) * tau(3)^3) / 0.2e1 + (0.3e1 / 0.4e1 * (tau(2)^5) * taud(1) - 0.3e1 / 0.2e1 * taud(2) * (tau(2)^4) * tau(1) + (0.5e1 / 0.4e1 * (f^2) * taud(1) - 0.7e1 / 0.2e1 * (f^2) * tau(1) - 0.3e1 / 0.2e1 * (tau(1)^2) * taud(1)) * (tau(2)^3) - 0.3e1 / 0.2e1 * tau(1) * taud(2) * ((f^2) + (tau(1)^2) / 0.3e1) * (tau(2)^2) + (-0.17e2 / 0.4e1 * (f^2) * taud(1) * (tau(1)^2) + (f^4 * taud(1)) / 0.2e1 - 0.9e1 / 0.2e1 * (f^4) * tau(1) - 0.9e1 / 0.2e1 * (f^2) * (tau(1)^3) - 0.13e2 / 0.4e1 * (tau(1)^4) * taud(1)) * tau(2) + (taud(2) * tau(1) * (f^2 + 2 * tau(1)^2) * (f^2 + tau(1)^2))) * (tau(3)^2) + (tau(2) * taud(3) * tau(1) * (3 * f^4 + 4 * f^2 * tau(1)^2 + 4 * f^2 * tau(2)^2 - tau(1)^4 + tau(2)^4) * tau(3)) + (f^2 + tau(1)^2 + tau(2)^2) * ((tau(2)^5 * taud(1)) / 0.4e1 + (f^2 * (taud(1) - 2 * tau(1)) * tau(2)^3) / 0.2e1 + ((f^2 * tau(1) * taud(2) - taud(2) * tau(1)^3) * tau(2)^2) + ((f^4 * taud(1)) / 0.4e1 - (f^4 * tau(1)) - (3 * f^2 * tau(1)^3) - 0.9e1 / 0.4e1 * (tau(1)^4) * taud(1)) * tau(2) + (taud(2) * tau(1) * (f^2 + tau(1)^2)^2))) * L^4 - ((2 * taud(2) * tau(2)^2 + (4 * f^2 + 6 * tau(1) * taud(1)) * tau(2) - 6 * taud(2) * tau(1)^2) * tau(3)^4 - 2 * tau(2) * taud(3) * (2 * f^2 - 3 * tau(1)^2 + tau(2)^2) * tau(3)^3 + (3 * taud(2) * tau(2)^4 + (5 * f^2 + 10 * tau(1) * taud(1)) * tau(2)^3 + (2 * taud(2) * f^2 - 3 * taud(2) * tau(1)^2) * tau(2)^2 + (6 * f^4 + 16 * f^2 * taud(1) * tau(1) + 11 * f^2 * tau(1)^2 + 14 * taud(1) * tau(1)^3) * tau(2) - 2 * taud(2) * (f^4 + 6 * f^2 * tau(1)^2 + 6 * tau(1)^4)) * tau(3)^2 - 2 * taud(3) * tau(2) * (tau(2)^4 + (3 * f^2 - 2 * tau(1)^2) * tau(2)^2 + 2 * f^4 + 3 * f^2 * tau(1)^2 - 7 * tau(1)^4) * tau(3) + taud(2) * tau(2)^6 + (f^2 + 2 * tau(1) * taud(1)) * tau(2)^5 + 2 * taud(2) * (f^2 + 2 * tau(1)^2) * tau(2)^4 + (2 * f^4 + 4 * f^2 * taud(1) * tau(1) + 10 * f^2 * tau(1)^2 + 14 * taud(1) * tau(1)^3) * tau(2)^3 + taud(2) * (f - tau(1))^2 * (f + tau(1))^2 * tau(2)^2 + (f^6 + 2 * f^4 * taud(1) * tau(1) + 10 * f^4 * tau(1)^2 + 14 * tau(1)^3 * f^2 * taud(1) + 13 * f^2 * tau(1)^4 + 16 * tau(1)^5 * taud(1)) * tau(2) - 6 * taud(2) * tau(1)^2 * (f^2 + tau(1)^2)^2) * acl2^2 * (tau(3)^2) * L^3 - 0.2e1 * (((taud(1) * tau(2) - 2 * tau(1) * taud(2)) * tau(3)^4) + (3 * tau(2) * taud(3) * tau(3)^3 * tau(1)) + ((2 * tau(2)^3 * taud(1)) - (2 * taud(2) * tau(2)^2 * tau(1)) + (0.5e1 / 0.2e1 * (f^2) * taud(1) + (2 * tau(1)^2 * taud(1))) * tau(2) - (2 * taud(2) * tau(1) * (f^2 + 2 * tau(1)^2))) * (tau(3)^2) + 0.3e1 * tau(1) * taud(3) * tau(2) * ((tau(2)^2) + 0.2e1 / 0.3e1 * (f^2) + (3 * tau(1)^2)) * tau(3) + (tau(2)^5 * taud(1)) / 0.2e1 + (taud(2) * tau(2)^4 * tau(1)) + ((f^2 * taud(1)) + (f^2 * tau(1)) + 0.9e1 / 0.2e1 * (tau(1)^2) * taud(1)) * (tau(2)^3) + (taud(2) * tau(1) * (f^2 + tau(1)^2) * tau(2)^2) + (0.9e1 / 0.2e1 * (f^2) * taud(1) * (tau(1)^2) + (f^4 * taud(1)) / 0.2e1 + (f^4 * tau(1)) + (3 * f^2 * tau(1)^3) + (7 * tau(1)^4 * taud(1))) * tau(2) - (2 * taud(2) * tau(1)^3 * (f^2 + tau(1)^2))) * acl2^3 * (tau(3)^3) * L^2 + acl2^4 * (taud(2) * tau(3)^4 - 2 * tau(2) * taud(3) * tau(3)^3 + (taud(2) * tau(2)^2 + (f^2 + 2 * tau(1) * taud(1)) * tau(2) + 2 * taud(2) * tau(1)^2) * tau(3)^2 - 2 * tau(2) * taud(3) * (f^2 + 5 * tau(1)^2 + tau(2)^2) * tau(3) - tau(1) * (2 * tau(2)^3 * taud(1) + taud(2) * tau(2)^2 * tau(1) + (2 * f^2 * taud(1) + f^2 * tau(1) + 6 * tau(1)^2 * taud(1)) * tau(2) - taud(2) * tau(1)^3)) * (tau(3)^4) * L - 0.2e1 * acl2^5 * ((taud(3) * tau(3) * tau(1)) - (tau(3)^2 * taud(1)) / 0.2e1 + (tau(1)^2 * taud(1)) / 0.2e1) * (tau(3)^5) * tau(2)) * cos(q(2))^2 + 0.2e1 * sin(q(2)) * (((tau(1) * (taud(2) * tau(2)^3 + (f^2 + 2 * tau(1) * taud(1)) * tau(2)^2 - taud(2) * tau(1)^2 * tau(2) - f^2 * tau(1)^2) * tau(3)^4) - (taud(3) * f^2 * tau(1) * (tau(2) - tau(1)) * (tau(2) + tau(1)) * tau(3)^3) + ((2 * taud(2) * tau(2)^5 * tau(1)) + ((f^2 * taud(1)) / 0.2e1 + (2 * f^2 * tau(1)) + (4 * tau(1)^2 * taud(1))) * (tau(2)^4) + (3 * taud(2) * tau(2)^3 * f^2 * tau(1)) + ((f^4 * taud(1)) / 0.2e1 + (3 * f^4 * tau(1)) + (4 * tau(1)^4 * taud(1)) + (7 * f^2 * taud(1) * tau(1)^2)) * (tau(2)^2) + ((-3 * f^2 * tau(1)^3 * taud(2) - 2 * tau(1)^5 * taud(2)) * tau(2)) + 0.3e1 / 0.2e1 * (tau(1)^2) * (f^2) * ((f^2 * taud(1)) - (2 * f^2 * tau(1)) + (tau(1)^2 * taud(1)) / 0.3e1 - 0.4e1 / 0.3e1 * (tau(1)^3))) * (tau(3)^2) - (2 * taud(3) * f^2 * tau(1) * (tau(2) - tau(1)) * (tau(2) + tau(1)) * (f^2 + tau(1)^2 + tau(2)^2) * tau(3)) + ((taud(2) * tau(2)^3 * tau(1)) + ((f^2 * taud(1)) / 0.2e1 + (f^2 * tau(1)) + (2 * tau(1)^2 * taud(1))) * (tau(2)^2) - (taud(2) * tau(2) * tau(1)^3) + (f^2 * (f^2 * taud(1) + 3 * tau(1)^2 * taud(1) - 2 * tau(1)^3)) / 0.2e1) * ((f^2 + tau(1)^2 + tau(2)^2)^2)) * L^4 + (((taud(2) * tau(2)^3 + (f^2 + 4 * tau(1) * taud(1)) * tau(2)^2 - 3 * taud(2) * tau(1)^2 * tau(2) - 3 * f^2 * tau(1)^2) * tau(3)^4) - (((f^2 - 2 * tau(1)^2) * tau(2)^2 - 3 * f^2 * tau(1)^2) * taud(3) * tau(3)^3) + ((2 * taud(2) * tau(2)^5) + ((2 * f^2 + 7 * tau(1) * taud(1)) * tau(2)^4) + (0.5e1 / 0.2e1 * taud(2) * (f^2) - (2 * taud(2) * tau(1)^2)) * (tau(2)^3) + (0.5e1 / 0.2e1 * (f^4) + (12 * f^2 * taud(1) * tau(1)) - (2 * f^2 * tau(1)^2) + (9 * taud(1) * tau(1)^3)) * (tau(2)^2) + (-0.13e2 / 0.2e1 * taud(2) * (f^2) * (tau(1)^2) - (6 * taud(2) * tau(1)^4)) * tau(2) + 0.3e1 * tau(1) * (f^2) * ((f^2 * taud(1)) - 0.13e2 / 0.6e1 * (f^2) * tau(1) + (tau(1)^2 * taud(1)) / 0.3e1 - (2 * tau(1)^3))) * (tau(3)^2) - (taud(3) * ((f^2 - 4 * tau(1)^2) * tau(2)^4 + (f^4 - 6 * f^2 * tau(1)^2 - 4 * tau(1)^4) * tau(2)^2 - 5 * f^4 * tau(1)^2 - 7 * f^2 * tau(1)^4) * tau(3)) + ((taud(2) * tau(2)^5) + ((f^2 + 3 * tau(1) * taud(1)) * tau(2)^4) + (0.3e1 / 0.2e1 * taud(2) * (f^2) + (2 * taud(2) * tau(1)^2)) * (tau(2)^3) + (0.3e1 / 0.2e1 * (f^4) + (6 * f^2 * taud(1) * tau(1)) + (2 * f^2 * tau(1)^2) + (7 * taud(1) * tau(1)^3)) * (tau(2)^2) + (taud(2) * (f^2 - 3 * tau(1)^2) * (f^2 + 2 * tau(1)^2) * tau(2)) / 0.2e1 + (f^2 * (f^4 + 6 * f^2 * taud(1) * tau(1) - f^2 * tau(1)^2 + 10 * taud(1) * tau(1)^3 - 6 * tau(1)^4)) / 0.2e1) * (f^2 + tau(1)^2 + tau(2)^2)) * acl2 * tau(3) * L^3 + 0.2e1 * ((-0.3e1 / 0.2e1 * taud(2) * tau(2) * tau(1) + (tau(2)^2 * taud(1)) - 0.3e1 / 0.2e1 * (f^2) * tau(1)) * (tau(3)^4) + 0.2e1 * tau(1) * taud(3) * ((tau(2)^2) + 0.3e1 / 0.4e1 * (f^2)) * (tau(3)^3) + (0.3e1 / 0.2e1 * (tau(2)^4) * taud(1) - 0.3e1 / 0.2e1 * taud(2) * (tau(2)^3) * tau(1) + (0.5e1 / 0.2e1 * (f^2) * taud(1) - 0.3e1 / 0.2e1 * (f^2) * tau(1) + 0.5e1 / 0.2e1 * (tau(1)^2) * taud(1)) * (tau(2)^2) + ((-2 * f^2 * tau(1) * taud(2) - 3 * taud(2) * tau(1)^3) * tau(2)) + 0.3e1 / 0.4e1 * (f^4) * taud(1) - (2 * f^4 * tau(1)) - (3 * f^2 * tau(1)^3)) * (tau(3)^2) + 0.3e1 * tau(1) * taud(3) * ((tau(2)^4) + (0.3e1 / 0.2e1 * (f^2) + 0.5e1 / 0.3e1 * (tau(1)^2)) * (tau(2)^2) + 0.2e1 / 0.3e1 * (f^4) + 0.3e1 / 0.2e1 * (f^2) * (tau(1)^2)) * tau(3) + (tau(2)^6 * taud(1)) / 0.2e1 + (taud(2) * tau(2)^5 * tau(1)) + ((f^2 * tau(1)) + 0.5e1 / 0.4e1 * (f^2) * taud(1) + (4 * tau(1)^2 * taud(1))) * (tau(2)^4) + 0.3e1 / 0.2e1 * tau(1) * taud(2) * ((f^2) + (tau(1)^2) / 0.3e1) * (tau(2)^3) + (0.3e1 / 0.2e1 * (f^4) * tau(1) + (f^2 * tau(1)^3) / 0.2e1 + 0.9e1 / 0.2e1 * (tau(1)^4) * taud(1) + (f^4 * taud(1)) + 0.27e2 / 0.4e1 * (f^2) * taud(1) * (tau(1)^2)) * (tau(2)^2) + (taud(2) * tau(1) * (f^4 - f^2 * tau(1)^2 - 3 * tau(1)^4) * tau(2)) / 0.2e1 + (f^2 * (f^4 * taud(1) + 2 * f^4 * tau(1) + 11 * f^2 * taud(1) * tau(1)^2 - 2 * f^2 * tau(1)^3 + 12 * tau(1)^4 * taud(1) - 6 * tau(1)^5)) / 0.4e1) * acl2^2 * (tau(3)^2) * L^2 - acl2^3 * (((f^2 + taud(2) * tau(2)) * tau(3)^4) + ((-taud(3) * f^2 - 2 * tau(2)^2 * taud(3)) * tau(3)^3) + ((taud(2) * tau(2)^3) + ((f^2 + tau(1) * taud(1)) * tau(2)^2) + (taud(2) * (f^2 + 4 * tau(1)^2) * tau(2)) / 0.2e1 + (f^2 * (f^2 + 2 * tau(1) * taud(1) + 4 * tau(1)^2)) / 0.2e1) * (tau(3)^2) - 0.2e1 * taud(3) * ((tau(2)^4) + (0.3e1 / 0.2e1 * (f^2) + (4 * tau(1)^2)) * (tau(2)^2) + (f^4) / 0.2e1 + 0.5e1 / 0.2e1 * (f^2) * (tau(1)^2)) * tau(3) - tau(1) * ((2 * tau(2)^4 * taud(1)) + (taud(2) * tau(2)^3 * tau(1)) + ((3 * f^2 * taud(1) + f^2 * tau(1) + 5 * tau(1)^2 * taud(1)) * tau(2)^2) + (taud(2) * tau(1) * (f^2 - 2 * tau(1)^2) * tau(2)) / 0.2e1 + (f^2) * ((f^2 * taud(1)) + (f^2 * tau(1)) / 0.2e1 + (3 * tau(1)^2 * taud(1)) - (tau(1)^3)))) * (tau(3)^3) * L + 0.2e1 * acl2^4 * ((taud(3) * tau(3) * tau(1)) - (tau(3)^2 * taud(1)) / 0.2e1 + (tau(1)^2 * taud(1)) / 0.2e1) * ((tau(2)^2) + (f^2) / 0.2e1) * (tau(3)^4)) * L * cos(q(2)) - (((taud(2) * tau(2)^3 + (f^2 + 2 * tau(1) * taud(1)) * tau(2)^2 - taud(2) * tau(1)^2 * tau(2) - f^2 * tau(1)^2) * tau(3)^4 - taud(3) * f^2 * (tau(2) - tau(1)) * (tau(2) + tau(1)) * tau(3)^3 + (2 * taud(2) * tau(2)^5 + (2 * f^2 + 4 * tau(1) * taud(1)) * tau(2)^4 + 3 * taud(2) * tau(2)^3 * f^2 + (3 * f^4 + 6 * f^2 * taud(1) * tau(1) + 4 * taud(1) * tau(1)^3) * tau(2)^2 + taud(2) * (f^4 - 3 * f^2 * tau(1)^2 - 2 * tau(1)^4) * tau(2) + f^2 * (f^4 + 2 * f^2 * taud(1) * tau(1) - 3 * f^2 * tau(1)^2 - 2 * tau(1)^4)) * tau(3)^2 - taud(3) * f^2 * (f^2 + tau(1)^2 + tau(2)^2) * (f^2 - 3 * tau(1)^2 + tau(2)^2) * tau(3) + (taud(2) * tau(2)^3 + (f^2 + 2 * tau(1) * taud(1)) * tau(2)^2 + (taud(2) * f^2 - taud(2) * tau(1)^2) * tau(2) + f^2 * (f^2 + 2 * tau(1) * taud(1) - tau(1)^2)) * (f^2 + tau(1)^2 + tau(2)^2)^2) * L^3 + 0.2e1 * (((-f^2 * tau(1) + tau(2)^2 * taud(1) - taud(2) * tau(2) * tau(1)) * tau(3)^4) + (taud(3) * tau(1) * (f^2 + tau(2)^2) * tau(3)^3) + (0.3e1 / 0.2e1 * (tau(2)^4) * taud(1) - (taud(2) * tau(2)^3 * tau(1)) + (0.5e1 / 0.2e1 * (f^2) * taud(1) - (f^2 * tau(1)) + 0.5e1 / 0.2e1 * (tau(1)^2) * taud(1)) * (tau(2)^2) - (2 * taud(2) * tau(1) * (f^2 + tau(1)^2) * tau(2)) + (f^2) * ((f^2 * taud(1)) - (2 * f^2 * tau(1)) - (2 * tau(1)^3) - (tau(1)^2 * taud(1)) / 0.2e1)) * (tau(3)^2) + (2 * tau(1) * (tau(2)^4 + (2 * f^2 + tau(1)^2) * tau(2)^2 + f^4 + 2 * f^2 * tau(1)^2) * taud(3) * tau(3)) + ((tau(2)^4 * taud(1)) / 0.2e1 + (taud(2) * tau(2)^3 * tau(1)) + ((f^2 * taud(1)) + (f^2 * tau(1)) + 0.5e1 / 0.2e1 * (tau(1)^2) * taud(1)) * (tau(2)^2) + ((f^2 * tau(1) * taud(2) - taud(2) * tau(1)^3) * tau(2)) + (f^2 * (f^2 * taud(1) + 2 * f^2 * tau(1) + 5 * tau(1)^2 * taud(1) - 2 * tau(1)^3)) / 0.2e1) * (f^2 + tau(1)^2 + tau(2)^2)) * acl2 * tau(3) * L^2 - acl2^2 * (tau(3)^2) * (((f^2 + taud(2) * tau(2)) * tau(3)^4) + ((-taud(3) * f^2 - 2 * tau(2)^2 * taud(3)) * tau(3)^3) + ((taud(2) * tau(2)^3 + f^2 * tau(2)^2 + taud(2) * (f^2 + 2 * tau(1)^2) * tau(2) + f^2 * (f^2 + 2 * tau(1) * taud(1) + 2 * tau(1)^2)) * tau(3)^2) - 0.2e1 * ((tau(2)^4) + ((2 * f^2 + 3 * tau(1)^2) * tau(2)^2) + (f^4) + 0.7e1 / 0.2e1 * (f^2) * (tau(1)^2)) * taud(3) * tau(3) - (tau(1) * (2 * tau(2)^4 * taud(1) + taud(2) * tau(2)^3 * tau(1) + (4 * f^2 * taud(1) + f^2 * tau(1) + 4 * tau(1)^2 * taud(1)) * tau(2)^2 + (f^2 * tau(1) * taud(2) - taud(2) * tau(1)^3) * tau(2) + 2 * f^4 * taud(1) + f^4 * tau(1) + 4 * f^2 * taud(1) * tau(1)^2 - f^2 * tau(1)^3))) * L + 0.2e1 * acl2^3 * ((taud(3) * tau(3) * tau(1)) - (tau(3)^2 * taud(1)) / 0.2e1 + (tau(1)^2 * taud(1)) / 0.2e1) * (tau(3)^3) * (f^2 + tau(2)^2)) * L^2 * tau(2)) * sqrt(m2 * acl2^2 + I2) * L / (((-tau(1)^2 + tau(2)^2) * L^2 - 0.2e1 * L * acl2 * tau(1) * tau(3) - acl2^2 * (tau(3)^2)) * cos(q(2))^2 + 0.2e1 * L * tau(2) * sin(q(2)) * (L * tau(1) + acl2 * tau(3)) * cos(q(2)) - L^2 * (tau(2)^2)) / (((tau(1)^2 + tau(2)^2) * tau(3)^2 + (f^2 + tau(1)^2 + tau(2)^2)^2) * L^2 + 0.2e1 * acl2 * tau(3) * tau(1) * (f^2 + tau(1)^2 + tau(2)^2 + tau(3)^2) * L + acl2^2 * (tau(3)^2) * (tau(1)^2 + tau(3)^2))^2;
df1dtau2 = f * sqrt(I1 + I2 + m2 * acl2^2 * cos(q(2))^2) * (((((tau(1)^2 + tau(2)^2)^2 * tau(3)^4 - taud(3) * (tau(1)^2 + tau(2)^2)^2 * tau(3)^3 + (2 * tau(1)^6 - tau(1)^5 * taud(1) + (3 * f^2 + 6 * tau(2)^2) * tau(1)^4 + (-f^2 * taud(1) - 2 * tau(2)^2 * taud(1)) * tau(1)^3 + (f^4 + 6 * f^2 * tau(2)^2 + 6 * tau(2)^4) * tau(1)^2 - tau(2)^2 * taud(1) * (3 * f^2 + tau(2)^2) * tau(1) - 2 * taud(2) * tau(2)^3 * f^2 + 2 * tau(2)^6 + 3 * tau(2)^4 * f^2 - tau(2)^2 * f^4) * tau(3)^2 - (tau(1)^4 + (f^2 + 4 * tau(2)^2) * tau(1)^2 + 3 * tau(2)^4 - f^2 * tau(2)^2) * (f^2 + tau(1)^2 + tau(2)^2) * taud(3) * tau(3) + (tau(1)^4 - taud(1) * tau(1)^3 + (f^2 + 2 * tau(2)^2) * tau(1)^2 + (-f^2 * taud(1) - 3 * tau(2)^2 * taud(1)) * tau(1) - 2 * taud(2) * tau(2)^3 + tau(2)^4 - f^2 * tau(2)^2) * (f^2 + tau(1)^2 + tau(2)^2)^2) * L^4) + 0.4e1 * (((tau(1)^3 + tau(1) * tau(2)^2) * tau(3)^4) - (tau(1) * taud(3) * (tau(1)^2 + tau(2)^2) * tau(3)^3) + ((2 * tau(1)^5) - (tau(1)^4 * taud(1)) + ((4 * tau(2)^2) + 0.9e1 / 0.4e1 * (f^2)) * (tau(1)^3) - 0.3e1 / 0.4e1 * taud(1) * (f^2 + tau(2)^2) * (tau(1)^2) + ((2 * tau(2)^4) + (f^4) / 0.2e1 + (taud(2) * tau(2)^3) / 0.2e1 + 0.11e2 / 0.4e1 * (f^2) * (tau(2)^2)) * tau(1) - (tau(2)^2 * taud(1) * (3 * f^2 + tau(2)^2)) / 0.4e1) * (tau(3)^2) - (f^2 + tau(1)^2 + 3 * tau(2)^2) * tau(1) * ((tau(1)^2) + (tau(2)^2) + (f^2) / 0.2e1) * taud(3) * tau(3) + ((tau(1)^5) - (tau(1)^4 * taud(1)) + ((2 * tau(2)^2) + 0.5e1 / 0.4e1 * (f^2)) * (tau(1)^3) - 0.11e2 / 0.4e1 * taud(1) * ((tau(2)^2) + 0.5e1 / 0.11e2 * (f^2)) * (tau(1)^2) + (-(taud(2) * tau(2)^3) + (tau(2)^4) + (f^2 * tau(2)^2) / 0.4e1 + (f^4) / 0.4e1) * tau(1) - 0.3e1 / 0.4e1 * taud(1) * ((tau(2)^2) + (f^2) / 0.3e1) * (f^2 + tau(2)^2)) * (f^2 + tau(1)^2 + tau(2)^2)) * tau(3) * acl2 * (L^3) + 0.6e1 * (((tau(1)^2) + (tau(2)^2) / 0.3e1) * (tau(3)^4) - ((tau(1)^2) + (tau(2)^2) / 0.3e1) * taud(3) * (tau(3)^3) + ((2 * tau(1)^4) - (taud(1) * tau(1)^3) + (0.3e1 / 0.2e1 * (f^2) + 0.7e1 / 0.3e1 * (tau(2)^2)) * (tau(1)^2) - (f^2 * taud(1) * tau(1)) / 0.2e1 + (tau(2)^4) / 0.3e1 + (taud(2) * tau(2)^3) / 0.3e1 + 0.5e1 / 0.6e1 * (f^2) * (tau(2)^2) + (f^4) / 0.6e1) * (tau(3)^2) - ((tau(1)^4) + (0.17e2 / 0.6e1 * (tau(2)^2) + (f^2)) * (tau(1)^2) + 0.5e1 / 0.6e1 * (tau(2)^4) + (f^2 * tau(2)^2) + (f^4) / 0.6e1) * taud(3) * tau(3) + tau(1) * ((tau(1)^5) - (tau(1)^4 * taud(1)) + ((2 * tau(2)^2) + 0.3e1 / 0.2e1 * (f^2)) * (tau(1)^3) - 0.5e1 / 0.2e1 * taud(1) * ((tau(2)^2) + 0.3e1 / 0.5e1 * (f^2)) * (tau(1)^2) + ((tau(2)^4) + (f^4) / 0.2e1 - (taud(2) * tau(2)^3) / 0.3e1 + 0.7e1 / 0.6e1 * (f^2) * (tau(2)^2)) * tau(1) - 0.7e1 / 0.6e1 * taud(1) * (f^2 + tau(2)^2) * ((tau(2)^2) + 0.3e1 / 0.7e1 * (f^2)))) * (tau(3)^2) * acl2^2 * (L^2) + 0.4e1 * ((tau(1) * tau(3)^4) - (tau(1) * taud(3) * tau(3)^3) + ((2 * tau(1)^3) - (tau(1)^2 * taud(1)) + ((tau(2)^2) + 0.3e1 / 0.4e1 * (f^2)) * tau(1) + (tau(2)^2 * taud(1)) / 0.4e1 - (f^2 * taud(1)) / 0.4e1) * (tau(3)^2) - tau(1) * ((tau(1)^2) + 0.3e1 / 0.2e1 * (tau(2)^2) + (f^2) / 0.2e1) * taud(3) * tau(3) + (tau(1)^2) * ((tau(1)^3) - (tau(1)^2 * taud(1)) + ((tau(2)^2) + 0.3e1 / 0.4e1 * (f^2)) * tau(1) - 0.5e1 / 0.4e1 * taud(1) * ((tau(2)^2) + 0.3e1 / 0.5e1 * (f^2)))) * (tau(3)^3) * acl2^3 * L + (tau(3)^4) * (tau(3)^2 - taud(3) * tau(3) + tau(1) * (tau(1) - taud(1))) * acl2^4 * (tau(1)^2 + tau(3)^2)) * sin(q(2)) - cos(q(2)) * ((L * tau(1)) + acl2 * tau(3)) * ((((taud(2) * tau(1)^4 + (taud(2) * f^2 + 2 * taud(2) * tau(2)^2) * tau(1)^2 - 2 * tau(2) * f^2 * taud(1) * tau(1) + tau(2) * (-2 * f^4 - taud(2) * tau(2) * f^2 + taud(2) * tau(2)^3)) * tau(3)^2 - 2 * tau(2) * taud(3) * (f^2 + tau(1)^2 + tau(2)^2) * (-f^2 + tau(1)^2 + tau(2)^2) * tau(3) + (f^2 + tau(1)^2 + tau(2)^2)^2 * (taud(2) * f^2 - 2 * tau(2) * f^2 - 2 * tau(2) * taud(1) * tau(1) + taud(2) * tau(1)^2 - taud(2) * tau(2)^2)) * L^3) + 0.3e1 * (((taud(2) * tau(1)^3) + 0.2e1 / 0.3e1 * (tau(1)^2) * tau(2) * taud(1) + (0.5e1 / 0.3e1 * taud(2) * (tau(2)^2) + 0.2e1 / 0.3e1 * taud(2) * (f^2) + 0.2e1 / 0.3e1 * tau(2) * (f^2)) * tau(1) - 0.2e1 / 0.3e1 * tau(2) * taud(1) * (f^2)) * (tau(3)^2) - 0.8e1 / 0.3e1 * tau(1) * tau(2) * ((tau(1)^2) + (tau(2)^2) + (f^2) / 0.2e1) * taud(3) * tau(3) + (f^2 + tau(1)^2 + tau(2)^2) * ((taud(2) * tau(1)^3) - (2 * tau(1)^2 * tau(2) * taud(1)) + (-(taud(2) * tau(2)^2) / 0.3e1 + (taud(2) * f^2) - 0.4e1 / 0.3e1 * tau(2) * (f^2)) * tau(1) - 0.2e1 / 0.3e1 * tau(2) * taud(1) * (f^2 + tau(2)^2))) * tau(3) * acl2 * (L^2) + 0.3e1 * (((taud(2) * tau(1)^2) + 0.4e1 / 0.3e1 * tau(2) * taud(1) * tau(1) + (taud(2) * tau(2)^2) + (taud(2) * f^2) / 0.3e1 + 0.2e1 / 0.3e1 * tau(2) * (f^2)) * (tau(3)^2) - 0.10e2 / 0.3e1 * ((tau(1)^2) + 0.2e1 / 0.5e1 * (tau(2)^2) + 0.2e1 / 0.5e1 * (f^2)) * tau(2) * taud(3) * tau(3) + tau(1) * ((taud(2) * tau(1)^3) - (2 * tau(1)^2 * tau(2) * taud(1)) + ((taud(2) * tau(2)^2) / 0.3e1 + (taud(2) * f^2) - 0.2e1 / 0.3e1 * tau(2) * (f^2)) * tau(1) - 0.4e1 / 0.3e1 * tau(2) * taud(1) * (f^2 + tau(2)^2))) * (tau(3)^2) * acl2^2 * L + ((2 * taud(1) * tau(2) + tau(1) * taud(2)) * tau(3)^2 - 4 * tau(1) * tau(2) * taud(3) * tau(3) + tau(1)^2 * (-2 * taud(1) * tau(2) + tau(1) * taud(2))) * (tau(3)^3) * acl2^3)) * (L^2) / ((((tau(1)^2 + tau(2)^2) * tau(3)^2 + (f^2 + tau(1)^2 + tau(2)^2)^2) * L^2) + 0.2e1 * acl2 * tau(3) * tau(1) * (f^2 + tau(1)^2 + tau(2)^2 + tau(3)^2) * L + acl2^2 * (tau(3)^2) * (tau(1)^2 + tau(3)^2))^2 / ((((tau(1)^2 - tau(2)^2) * L^2) + 0.2e1 * L * acl2 * tau(1) * tau(3) + acl2^2 * (tau(3)^2)) * cos(q(2))^2 - 0.2e1 * L * tau(2) * sin(q(2)) * ((L * tau(1)) + acl2 * tau(3)) * cos(q(2)) + (L^2 * tau(2)^2));
df2dtau2 = -0.2e1 * sqrt(m2 * acl2^2 + I2) * L * ((-L^5 * taud(1) * tau(2)^8 / 0.2e1 + L^5 * tau(1) * taud(2) * tau(2)^7 - 0.2e1 * (L * (L * taud(1) - L * tau(1) - acl2 * tau(3) / 0.4e1) * f^2 + tau(3) * (-L * acl2 * taud(1) * tau(1) / 0.2e1 + ((L^2 - acl2^2 / 0.2e1) * taud(1) + 0.3e1 / 0.2e1 * L * taud(3) * acl2) * tau(3)) / 0.2e1) * L^3 * tau(2)^6 + ((L^2 * tau(1) - L * acl2 * tau(3)) * f^2 + L^2 * tau(1)^3 + tau(3)^2 * (0.2e1 * L^2 - acl2^2) * tau(1) + 0.2e1 * L * acl2 * tau(3)^3) * taud(2) * L^3 * tau(2)^5 - 0.4e1 * ((-acl2 * tau(3) * L^2 / 0.8e1 + 0.3e1 / 0.4e1 * L^3 * taud(1) - L^3 * tau(1)) * f^4 + (-L^2 * tau(1)^3 + (-0.9e1 / 0.8e1 * L * acl2 * tau(3) + L^2 * taud(1) / 0.2e1) * tau(1)^2 + (0.3e1 / 0.8e1 * L * acl2 * taud(1) + (-acl2^2 / 0.8e1 - L^2) * tau(3) + L^2 * taud(3)) * tau(3) * tau(1) + tau(3)^2 * ((L^2 - acl2^2 / 0.4e1) * taud(1) + 0.5e1 / 0.2e1 * acl2 * (taud(3) - 0.7e1 / 0.10e2 * tau(3)) * L) / 0.2e1) * L * f^2 - L^3 * taud(1) * tau(1)^4 / 0.4e1 - 0.5e1 / 0.8e1 * L^2 * acl2 * taud(1) * tau(1)^3 * tau(3) - ((L^2 + 0.2e1 * acl2^2) * taud(1) + L * taud(3) * acl2 / 0.2e1) * tau(3)^2 * L * tau(1)^2 / 0.4e1 - 0.7e1 / 0.8e1 * acl2 * ((L^2 + acl2^2 / 0.7e1) * taud(1) + 0.4e1 / 0.7e1 * L * taud(3) * acl2) * tau(3)^3 * tau(1) + ((L^3 - 0.5e1 * L * acl2^2) * taud(1) + taud(3) * acl2 * (L^2 - 0.3e1 * acl2^2)) * tau(3)^4 / 0.8e1) * L^2 * tau(2)^4 - taud(2) * L^2 * ((L^3 * tau(1) + 0.2e1 * acl2 * tau(3) * L^2) * f^4 + (0.2e1 * L^3 * tau(1)^3 + 0.6e1 * L^2 * acl2 * tau(3) * tau(1)^2 + (-0.3e1 * L^3 + 0.4e1 * L * acl2^2) * tau(3)^2 * tau(1) - 0.2e1 * L^2 * acl2 * tau(3)^3) * f^2 - (-L^2 * tau(1)^2 - 0.3e1 * L * acl2 * tau(1) * tau(3) + tau(3)^2 * (L^2 - 0.2e1 * acl2^2)) * (L * tau(1) + acl2 * tau(3)) * (tau(1)^2 + tau(3)^2)) * tau(2)^3 - 0.4e1 * (L^3 * (L * taud(1) - L * tau(1) + acl2 * tau(3) / 0.4e1) * f^6 / 0.2e1 + (-L^2 * tau(1)^3 + L * (-0.3e1 / 0.4e1 * acl2 * tau(3) + L * taud(1)) * tau(1)^2 + tau(3) * (0.9e1 / 0.8e1 * L * acl2 * taud(1) + (acl2^2 / 0.4e1 - 0.3e1 / 0.2e1 * L^2) * tau(3) + L^2 * taud(3)) * tau(1) + tau(3)^2 * ((L^2 + acl2^2 / 0.2e1) * taud(1) + 0.7e1 / 0.2e1 * acl2 * L * (taud(3) - 0.9e1 / 0.7e1 * tau(3))) / 0.4e1) * L^2 * f^4 + (-L^2 * tau(1)^4 + L * (-0.3e1 / 0.4e1 * acl2 * tau(3) + L * taud(1)) * tau(1)^3 + 0.2e1 * (0.3e1 / 0.4e1 * L * acl2 * taud(1) + (-L^2 + acl2^2 / 0.8e1) * tau(3) + L^2 * taud(3)) * tau(3) * tau(1)^2 - tau(3)^2 * ((L^2 - acl2^2 / 0.2e1) * taud(1) - acl2 * (taud(3) - tau(3) / 0.2e1) * L) * tau(1) + (-0.5e1 / 0.4e1 * L * acl2 * taud(1) + (-L^2 + 0.3e1 / 0.4e1 * acl2^2) * tau(3) + taud(3) * (L^2 - acl2^2 / 0.2e1)) * tau(3)^3) * (L * tau(1) + acl2 * tau(3)) * L * f^2 / 0.2e1 - (-L * acl2 * taud(1) * tau(1)^3 / 0.2e1 + ((L^2 - acl2^2 / 0.2e1) * taud(1) + 0.3e1 / 0.2e1 * L * taud(3) * acl2) * tau(3) * tau(1)^2 - acl2 * tau(3)^2 * (L * taud(1) - taud(3) * acl2) * tau(1) + tau(3)^3 * ((L^2 - 0.3e1 / 0.2e1 * acl2^2) * taud(1) + L * taud(3) * acl2)) * (L * tau(1) + acl2 * tau(3))^2 * tau(3) / 0.4e1) * L * tau(2)^2 - (L * f^2 + tau(1)^2 * L + L * tau(3)^2 + acl2 * tau(1) * tau(3)) * taud(2) * (L^2 * f^4 + (0.2e1 * L^2 * tau(1)^2 + 0.2e1 * L * acl2 * tau(1) * tau(3)) * f^2 + (tau(1)^2 + tau(3)^2) * (L * tau(1) + acl2 * tau(3))^2) * (L * tau(1) + acl2 * tau(3)) * L * tau(2) - ((L^3 * taud(1) + acl2 * tau(3) * L^2) * f^4 + 0.2e1 * (L * tau(1) + acl2 * tau(3)) * ((L * taud(1) + acl2 * tau(3) / 0.2e1) * tau(1) + acl2 * tau(3) * taud(1) / 0.2e1) * L * f^2 + (L * tau(1) + acl2 * tau(3))^2 * (L * taud(1) * tau(1)^2 + acl2 * tau(3) * taud(1) * tau(1) + tau(3)^2 * (L * taud(1) + taud(3) * acl2))) * (L^2 * f^4 + (0.2e1 * L^2 * tau(1)^2 + 0.2e1 * L * acl2 * tau(1) * tau(3)) * f^2 + (tau(1)^2 + tau(3)^2) * (L * tau(1) + acl2 * tau(3))^2) / 0.2e1) * cos(q(2))^2 + 0.3e1 / 0.2e1 * sin(q(2)) * (-0.2e1 / 0.3e1 * (L * f^2 + taud(1) * (L * tau(1) + acl2 * tau(3))) * L^3 * tau(2)^7 + taud(2) * (L * f^2 + 0.4e1 / 0.3e1 * tau(1) * (L * tau(1) + acl2 * tau(3))) * L^3 * tau(2)^6 + 0.4e1 / 0.3e1 * (-L^2 * f^4 + L * (-tau(1)^2 * L / 0.2e1 + (-L * taud(1) - acl2 * tau(3) / 0.2e1) * tau(1) + (-acl2 * taud(1) + L * (taud(3) - tau(3))) * tau(3)) * f^2 - (L * taud(1) * tau(1)^2 / 0.2e1 + acl2 * tau(3) * taud(1) * tau(1) / 0.2e1 + tau(3)^2 * (L * taud(1) + 0.3e1 / 0.2e1 * taud(3) * acl2)) * (L * tau(1) + acl2 * tau(3))) * L^2 * tau(2)^5 + 0.7e1 / 0.3e1 * taud(2) * (L^2 * f^4 + L * (0.15e2 * tau(1)^2 * L + L * tau(3)^2 + 0.15e2 * acl2 * tau(1) * tau(3)) * f^2 / 0.7e1 + 0.8e1 / 0.7e1 * (tau(1)^2 + tau(3)^2) * (L * tau(1) + acl2 * tau(3))^2) * L^2 * tau(2)^4 + 0.4e1 / 0.3e1 * (-L^3 * f^6 / 0.2e1 + (-L * taud(1) * tau(1) / 0.2e1 + (-acl2 * taud(1) / 0.2e1 + L * (-0.3e1 / 0.2e1 * tau(3) + taud(3))) * tau(3)) * L^2 * f^4 + (L^2 * tau(1)^4 + 0.2e1 * L * acl2 * tau(3) * tau(1)^3 + acl2^2 * tau(3)^2 * tau(1)^2 - 0.3e1 * tau(3)^2 * (L * taud(1) + 0.4e1 / 0.3e1 * acl2 * (taud(3) - 0.3e1 / 0.4e1 * tau(3))) * L * tau(1) + tau(3)^3 * (-0.3e1 * L * acl2 * taud(1) + (-L^2 + 0.3e1 * acl2^2) * tau(3) + taud(3) * (L^2 - 0.4e1 * acl2^2))) * L * f^2 / 0.2e1 - (-L^2 * taud(1) * tau(1)^4 - 0.2e1 * L * acl2 * taud(1) * tau(3) * tau(1)^3 + (0.2e1 * L * acl2 * tau(3)^2 * taud(3) - acl2^2 * taud(1) * tau(3)^2) * tau(1)^2 + (-0.3e1 * L * acl2 * taud(1) * tau(3)^3 + 0.2e1 * acl2^2 * tau(3)^3 * taud(3)) * tau(1) + tau(3)^4 * ((L^2 - 0.3e1 * acl2^2) * taud(1) + L * taud(3) * acl2)) * (L * tau(1) + acl2 * tau(3)) / 0.2e1) * L * tau(2)^3 + 0.5e1 / 0.3e1 * taud(2) * (L^3 * f^6 + (0.3e1 / 0.5e1 * L^3 * tau(3)^2 + 0.14e2 / 0.5e1 * tau(1)^2 * L^3 + 0.14e2 / 0.5e1 * L^2 * acl2 * tau(3) * tau(1)) * f^4 + 0.14e2 / 0.5e1 * (L * tau(1) + acl2 * tau(3)) * (tau(3)^2 * tau(1) * L + 0.13e2 / 0.14e2 * L * tau(1)^3 + acl2 * tau(3)^3 / 0.2e1 + 0.13e2 / 0.14e2 * acl2 * tau(3) * tau(1)^2) * L * f^2 + 0.4e1 / 0.5e1 * (tau(1)^2 + tau(3)^2) * (tau(1)^2 * L + L * tau(3)^2 + acl2 * tau(1) * tau(3)) * (L * tau(1) + acl2 * tau(3))^2) * L * tau(2)^2 - 0.4e1 / 0.3e1 * (L * tau(1) + acl2 * tau(3)) * (-L^3 * f^6 * tau(1) / 0.2e1 + L^2 * (-L * tau(1)^3 + (-acl2 * tau(3) - L * taud(1) / 0.2e1) * tau(1)^2 + (-acl2 * taud(1) / 0.2e1 + L * (-0.3e1 / 0.2e1 * tau(3) + taud(3))) * tau(3) * tau(1) + acl2 * tau(3)^2 * (taud(3) - 0.2e1 * tau(3)) / 0.2e1) * f^4 + (-L * tau(1)^4 + (-0.2e1 * L * taud(1) - acl2 * tau(3)) * tau(1)^3 + 0.2e1 * (-acl2 * taud(1) + L * (taud(3) - tau(3))) * tau(3) * tau(1)^2 + (-0.3e1 * L * taud(1) * tau(3)^2 - acl2 * tau(3)^3) * tau(1) + tau(3)^3 * (-0.2e1 * acl2 * taud(1) + L * (taud(3) - tau(3)))) * (L * tau(1) + acl2 * tau(3)) * L * f^2 / 0.2e1 - (L * tau(1) + acl2 * tau(3))^2 * (L * taud(1) * tau(1)^2 + acl2 * tau(3) * taud(1) * tau(1) + tau(3)^2 * (L * taud(1) + taud(3) * acl2)) * (tau(1)^2 + tau(3)^2) / 0.2e1) * tau(2) + (L * f^2 + tau(1)^2 * L + acl2 * tau(1) * tau(3)) * f^2 * taud(2) * (L^2 * f^4 + (0.2e1 * L^2 * tau(1)^2 + 0.2e1 * L * acl2 * tau(1) * tau(3)) * f^2 + (tau(1)^2 + tau(3)^2) * (L * tau(1) + acl2 * tau(3))^2) * L / 0.3e1) * L * cos(q(2)) - (-L^3 * tau(2)^8 * taud(1) / 0.2e1 + L^3 * taud(2) * tau(2)^7 * tau(1) - 0.2e1 * (L * (taud(1) - 0.3e1 / 0.4e1 * tau(1)) * f^2 + L * taud(1) * tau(1)^2 / 0.4e1 + acl2 * tau(3) * taud(1) * tau(1) / 0.4e1 + tau(3)^2 * (L * taud(1) + 0.3e1 / 0.2e1 * taud(3) * acl2) / 0.2e1) * L^2 * tau(2)^6 + 0.2e1 * taud(2) * (L * f^2 * tau(1) + (tau(1)^2 + tau(3)^2) * (L * tau(1) + acl2 * tau(3))) * L^2 * tau(2)^5 - 0.5e1 / 0.2e1 * (0.6e1 / 0.5e1 * (taud(1) - 0.7e1 / 0.6e1 * tau(1)) * L^2 * f^4 + (-0.7e1 / 0.5e1 * L * tau(1)^3 + (L * taud(1) - 0.7e1 / 0.5e1 * acl2 * tau(3)) * tau(1)^2 + (acl2 * taud(1) + L * (taud(3) - 0.6e1 / 0.5e1 * tau(3))) * tau(3) * tau(1) + 0.4e1 / 0.5e1 * tau(3)^2 * (L * taud(1) + 0.7e1 / 0.4e1 * acl2 * (taud(3) - 0.5e1 / 0.7e1 * tau(3)))) * L * f^2 - L^2 * taud(1) * tau(1)^4 / 0.5e1 - 0.2e1 / 0.5e1 * L * acl2 * taud(1) * tau(3) * tau(1)^3 + 0.2e1 / 0.5e1 * acl2 * (L * taud(3) - acl2 * taud(1) / 0.2e1) * tau(3)^2 * tau(1)^2 - 0.3e1 / 0.5e1 * (L * taud(1) - 0.2e1 / 0.3e1 * taud(3) * acl2) * acl2 * tau(3)^3 * tau(1) + tau(3)^4 * ((L^2 - 0.3e1 * acl2^2) * taud(1) + L * taud(3) * acl2) / 0.5e1) * L * tau(2)^4 + taud(2) * (L^2 * f^4 * tau(1) + (0.2e1 * L^2 * tau(1)^3 + 0.3e1 * L^2 * tau(1) * tau(3)^2 + 0.2e1 * L * acl2 * tau(1)^2 * tau(3) + 0.2e1 * L * acl2 * tau(3)^3) * f^2 + (tau(1)^2 + tau(3)^2) * (tau(1)^2 * L + L * tau(3)^2 + acl2 * tau(1) * tau(3)) * (L * tau(1) + acl2 * tau(3))) * L * tau(2)^3 + (-0.2e1 * (taud(1) - 0.5e1 / 0.4e1 * tau(1)) * L^3 * f^6 - 0.3e1 * (-0.5e1 / 0.3e1 * L * tau(1)^3 + (0.7e1 / 0.6e1 * L * taud(1) - 0.5e1 / 0.3e1 * acl2 * tau(3)) * tau(1)^2 + tau(3) * (0.7e1 / 0.6e1 * acl2 * taud(1) + L * (-0.3e1 / 0.2e1 * tau(3) + taud(3))) * tau(1) + (L * taud(1) + 0.5e1 / 0.2e1 * acl2 * (taud(3) - 0.6e1 / 0.5e1 * tau(3))) * tau(3)^2 / 0.3e1) * L^2 * f^4 - 0.3e1 / 0.2e1 * (-0.5e1 / 0.3e1 * L * tau(1)^4 + (0.2e1 / 0.3e1 * L * taud(1) - 0.5e1 / 0.3e1 * acl2 * tau(3)) * tau(1)^3 + 0.2e1 * (acl2 * taud(1) / 0.3e1 + L * (taud(3) - 0.4e1 / 0.3e1 * tau(3))) * tau(3) * tau(1)^2 - tau(3)^2 * (L * taud(1) - 0.4e1 * acl2 * (taud(3) - 0.5e1 / 0.4e1 * tau(3))) * tau(1) / 0.3e1 + tau(3)^3 * (-0.2e1 / 0.3e1 * acl2 * taud(1) + L * (taud(3) - tau(3)))) * (L * tau(1) + acl2 * tau(3)) * L * f^2 + (L * tau(1) + acl2 * tau(3))^2 * (L * taud(1) * tau(1)^2 + acl2 * tau(3) * taud(1) * tau(1) + tau(3)^2 * (L * taud(1) + taud(3) * acl2)) * (tau(1)^2 + tau(3)^2) / 0.2e1) * tau(2)^2 - (L * (taud(1) - tau(1)) * f^2 + (L * tau(1) + acl2 * tau(3)) * (-tau(1)^2 + tau(1) * taud(1) + tau(3) * (taud(3) - tau(3)))) * f^2 * (L^2 * f^4 + (0.2e1 * L^2 * tau(1)^2 + 0.2e1 * L * acl2 * tau(1) * tau(3)) * f^2 + (tau(1)^2 + tau(3)^2) * (L * tau(1) + acl2 * tau(3))^2) / 0.2e1) * L^2) / ((L^2 * tau(2)^2 - (L * tau(1) + acl2 * tau(3))^2) * cos(q(2))^2 + 0.2e1 * L * tau(2) * sin(q(2)) * (L * tau(1) + acl2 * tau(3)) * cos(q(2)) - L^2 * tau(2)^2) / (L^2 * tau(2)^4 + (0.2e1 * L^2 * f^2 + 0.2e1 * L^2 * tau(1)^2 + L^2 * tau(3)^2 + 0.2e1 * L * acl2 * tau(1) * tau(3)) * tau(2)^2 + L^2 * f^4 + (0.2e1 * L^2 * tau(1)^2 + 0.2e1 * L * acl2 * tau(1) * tau(3)) * f^2 + (tau(1)^2 + tau(3)^2) * (L * tau(1) + acl2 * tau(3))^2)^2;
df1dtau3 = -sqrt(I1 + I2 + m2 * acl2^2 * cos(q(2))^2) * f * (((tau(1) * (tau(1)^4 * taud(3) - 2 * tau(3) * taud(1) * tau(1)^3 + (-taud(3) * tau(3)^2 + (-2 * f^2 - 2 * taud(2) * tau(2)) * tau(3) + 2 * taud(3) * (f^2 + tau(2)^2)) * tau(1)^2 - 2 * tau(3) * taud(1) * (f^2 + tau(2)^2) * tau(1) - tau(2)^2 * taud(3) * tau(3)^2 - 2 * (f^2 + tau(2)^2) * (f^2 + taud(2) * tau(2)) * tau(3) + taud(3) * (f^2 + tau(2)^2)^2) * (tau(1)^2 + tau(2)^2) * L^5) + ((tau(1)^8) - (taud(1) * tau(1)^7) + ((2 * f^2 - 2 * taud(2) * tau(2) + 4 * tau(2)^2 + 2 * tau(3)^2 + 4 * taud(3) * tau(3)) * tau(1)^6) - 0.2e1 * taud(1) * ((tau(2)^2) + (f^2) + 0.11e2 / 0.2e1 * (tau(3)^2)) * (tau(1)^5) + ((tau(3)^4) - (6 * taud(3) * tau(3)^3) + ((-6 * f^2 - 10 * taud(2) * tau(2) + 6 * tau(2)^2) * tau(3)^2) + (8 * taud(3) * (f^2 + tau(2)^2) * tau(3)) - 0.5e1 * ((taud(2) * tau(2)) - 0.6e1 / 0.5e1 * (tau(2)^2) - (f^2) / 0.5e1) * (f^2 + tau(2)^2)) * (tau(1)^4) - (taud(1) * ((10 * f^2 + 15 * tau(2)^2) * tau(3)^2 + (f^2 + tau(2)^2)^2) * tau(1)^3) + ((2 * tau(2)^2 * tau(3)^4 - 8 * tau(2)^2 * taud(3) * tau(3)^3 + (-7 * f^4 - 9 * taud(2) * tau(2) * f^2 - 5 * f^2 * tau(2)^2 - 13 * taud(2) * tau(2)^3 + 6 * tau(2)^4) * tau(3)^2 + 4 * taud(3) * (f^2 + tau(2)^2)^2 * tau(3) - 4 * tau(2) * (f^2 + tau(2)^2)^2 * (taud(2) - tau(2))) * tau(1)^2) - (4 * tau(2)^2 * tau(3)^2 * taud(1) * (f^2 + tau(2)^2) * tau(1)) - tau(2) * (-(tau(2)^3 * tau(3)^4) + (2 * tau(2)^3 * taud(3) * tau(3)^3) + 0.3e1 * tau(2) * ((taud(2) * tau(2)) - 0.2e1 / 0.3e1 * (tau(2)^2) + (f^2) / 0.3e1) * (f^2 + tau(2)^2) * (tau(3)^2) + ((f^2 + tau(2)^2)^3 * (taud(2) - tau(2))))) * acl2 * (L^4) + 0.4e1 * tau(3) * acl2^2 * ((tau(1)^7) - (tau(1)^6 * taud(1)) + (-0.3e1 / 0.2e1 * taud(2) * tau(2) + 0.3e1 / 0.2e1 * taud(3) * tau(3) + (3 * tau(2)^2) + 0.3e1 / 0.2e1 * (f^2) + (2 * tau(3)^2)) * (tau(1)^5) - 0.3e1 / 0.2e1 * taud(1) * (f^2 + tau(2)^2 + 4 * tau(3)^2) * (tau(1)^4) + ((tau(3)^4) - 0.7e1 / 0.2e1 * taud(3) * (tau(3)^3) + ((4 * tau(2)^2) - 0.3e1 / 0.2e1 * (f^2) - 0.9e1 / 0.2e1 * taud(2) * tau(2)) * (tau(3)^2) + (0.9e1 / 0.4e1 * (tau(2)^2) * taud(3) + (3 * taud(3) * f^2)) * tau(3) - 0.5e1 / 0.2e1 * ((taud(2) * tau(2)) - 0.6e1 / 0.5e1 * (tau(2)^2) - (f^2) / 0.5e1) * (f^2 + tau(2)^2)) * (tau(1)^3) - (taud(1) * ((9 * f^2 + 11 * tau(2)^2) * tau(3)^2 + (f^2 + tau(2)^2)^2) * tau(1)^2) / 0.2e1 + ((tau(2)^2 * tau(3)^4) - 0.5e1 / 0.2e1 * (tau(2)^2) * taud(3) * (tau(3)^3) + (-(2 * f^4) + (2 * tau(2)^4) - (3 * taud(2) * tau(2) * f^2) - (f^2 * tau(2)^2) / 0.2e1 - 0.7e1 / 0.2e1 * taud(2) * (tau(2)^3)) * (tau(3)^2) + 0.3e1 / 0.4e1 * ((tau(2)^2) + 0.5e1 / 0.3e1 * (f^2)) * taud(3) * (f^2 + tau(2)^2) * tau(3) - (tau(2) * (f^2 + tau(2)^2)^2 * (taud(2) - tau(2)))) * tau(1) - (tau(2)^2 * tau(3)^2 * taud(1) * (f^2 + tau(2)^2)) / 0.2e1) * (L^3) + 0.6e1 * ((tau(1)^6) - (tau(1)^5 * taud(1)) + (-(taud(2) * tau(2)) + 0.2e1 / 0.3e1 * taud(3) * tau(3) + (2 * tau(2)^2) + (f^2) + (2 * tau(3)^2)) * (tau(1)^4) - taud(1) * ((tau(2)^2) + (f^2) + 0.13e2 / 0.3e1 * (tau(3)^2)) * (tau(1)^3) + ((tau(3)^4) - 0.8e1 / 0.3e1 * taud(3) * (tau(3)^3) + (0.7e1 / 0.3e1 * (tau(2)^2) - (f^2) / 0.3e1 - 0.7e1 / 0.3e1 * taud(2) * tau(2)) * (tau(3)^2) + ((tau(2)^2) + 0.4e1 / 0.3e1 * (f^2)) * taud(3) * tau(3) - 0.5e1 / 0.6e1 * ((taud(2) * tau(2)) - 0.6e1 / 0.5e1 * (tau(2)^2) - (f^2) / 0.5e1) * (f^2 + tau(2)^2)) * (tau(1)^2) - (taud(1) * ((14 * f^2 + 15 * tau(2)^2) * tau(3)^2 + (f^2 + tau(2)^2)^2) * tau(1)) / 0.6e1 - 0.5e1 / 0.6e1 * tau(3) * (-0.2e1 / 0.5e1 * (tau(2)^2) * (tau(3)^3) + 0.4e1 / 0.5e1 * (tau(2)^2) * taud(3) * (tau(3)^2) + ((taud(2) * tau(2)) - 0.2e1 / 0.5e1 * (tau(2)^2) + 0.3e1 / 0.5e1 * (f^2)) * (f^2 + tau(2)^2) * tau(3) - 0.2e1 / 0.5e1 * taud(3) * ((f^2 + tau(2)^2)^2))) * (tau(3)^2) * acl2^3 * (L^2) + 0.4e1 * (tau(3)^3) * acl2^4 * ((tau(1)^5) - (tau(1)^4 * taud(1)) + (-(taud(2) * tau(2)) / 0.2e1 + (tau(2)^2) + (taud(3) * tau(3)) / 0.4e1 + (f^2) / 0.2e1 + (2 * tau(3)^2)) * (tau(1)^3) - (taud(1) * (f^2 + tau(2)^2 + 7 * tau(3)^2) * tau(1)^2) / 0.2e1 - tau(3) * (-(tau(3)^3) + 0.9e1 / 0.4e1 * taud(3) * (tau(3)^2) + (tau(2) * (taud(2) - tau(2)) * tau(3)) - (taud(3) * (f^2 + tau(2)^2)) / 0.2e1) * tau(1) - (tau(3)^2 * taud(1) * (f^2 + tau(2)^2))) * L + acl2^5 * (tau(3)^4) * (-taud(1) * tau(1)^3 - 3 * taud(1) * tau(1) * tau(3)^2 + tau(1)^4 + 2 * tau(1)^2 * tau(3)^2 + tau(3)^4 - 2 * taud(3) * tau(3)^3)) * cos(q(2)) - (((tau(1)^4 * taud(3) - 2 * tau(3) * taud(1) * tau(1)^3 + (-taud(3) * tau(3)^2 + (-2 * f^2 - 2 * taud(2) * tau(2)) * tau(3) + 2 * taud(3) * (f^2 + tau(2)^2)) * tau(1)^2 - 2 * tau(3) * taud(1) * (f^2 + tau(2)^2) * tau(1) - tau(2)^2 * taud(3) * tau(3)^2 - 2 * (f^2 + tau(2)^2) * (f^2 + taud(2) * tau(2)) * tau(3) + taud(3) * (f^2 + tau(2)^2)^2) * (tau(1)^2 + tau(2)^2) * L^4) - acl2 * (((f^2 + taud(2) * tau(2) - 4 * taud(3) * tau(3)) * tau(1)^5) - (taud(1) * (f^2 + tau(2)^2 - 8 * tau(3)^2) * tau(1)^4) + ((4 * taud(3) * tau(3)^3 + (7 * f^2 + 7 * taud(2) * tau(2)) * tau(3)^2 - 8 * taud(3) * (f^2 + tau(2)^2) * tau(3) + 2 * (f^2 + tau(2)^2) * (f^2 + taud(2) * tau(2))) * tau(1)^3) - 0.2e1 * taud(1) * ((-0.9e1 / 0.2e1 * (tau(2)^2) - 0.7e1 / 0.2e1 * (f^2)) * (tau(3)^2) + ((f^2 + tau(2)^2)^2)) * (tau(1)^2) + ((4 * tau(2)^2 * taud(3) * tau(3)^3) + 0.7e1 * ((tau(2)^2) + 0.6e1 / 0.7e1 * (f^2)) * (f^2 + taud(2) * tau(2)) * (tau(3)^2) - (4 * taud(3) * (f^2 + tau(2)^2)^2 * tau(3)) + ((f^2 + tau(2)^2)^2 * (f^2 + taud(2) * tau(2)))) * tau(1) - (taud(1) * (f^2 + tau(2)^2) * (f^2 + tau(2)^2 + tau(2) * tau(3)) * (f^2 + tau(2)^2 - tau(2) * tau(3)))) * (L^3) - 0.2e1 * (((f^2 + taud(2) * tau(2) - 3 * taud(3) * tau(3)) * tau(1)^4) - (taud(1) * (f^2 + tau(2)^2 - 6 * tau(3)^2) * tau(1)^3) + ((3 * taud(3) * tau(3)^3) + ((4 * f^2 + 4 * taud(2) * tau(2)) * tau(3)^2) + (-0.9e1 / 0.2e1 * (tau(2)^2) * taud(3) - (5 * taud(3) * f^2)) * tau(3) + ((f^2 + tau(2)^2) * (f^2 + taud(2) * tau(2)))) * (tau(1)^2) - (taud(1) * (f^2 + tau(2)^2) * (f^2 + tau(2)^2 - 4 * tau(3)^2) * tau(1)) + 0.2e1 * ((tau(2)^2 * taud(3) * tau(3)^2) / 0.2e1 + ((f^2 + tau(2)^2) * (f^2 + taud(2) * tau(2)) * tau(3)) - 0.3e1 / 0.4e1 * taud(3) * ((f^2 + tau(2)^2)^2)) * tau(3)) * tau(3) * acl2^2 * (L^2) - ((f^2 + taud(2) * tau(2) - 4 * taud(3) * tau(3)) * tau(1)^3 - taud(1) * (f^2 + tau(2)^2 - 8 * tau(3)^2) * tau(1)^2 + (4 * taud(3) * tau(3)^3 + (3 * f^2 + 3 * taud(2) * tau(2)) * tau(3)^2 - 4 * taud(3) * (f^2 + tau(2)^2) * tau(3)) * tau(1) + 3 * tau(3)^2 * taud(1) * (f^2 + tau(2)^2)) * (tau(3)^2) * acl2^3 * L + acl2^4 * (tau(3)^4) * (-2 * taud(1) * tau(1) * tau(3) + tau(1)^2 * taud(3) - taud(3) * tau(3)^2)) * tau(2) * sin(q(2)) * L) * L / (((tau(1)^4 + (2 * f^2 + 2 * tau(2)^2 + tau(3)^2) * tau(1)^2 + tau(3)^2 * tau(2)^2 + (f^2 + tau(2)^2)^2) * L^2) + 0.2e1 * acl2 * tau(3) * tau(1) * (f^2 + tau(1)^2 + tau(2)^2 + tau(3)^2) * L + acl2^2 * (tau(3)^2) * (tau(1)^2 + tau(3)^2))^2 / ((((tau(1)^2 - tau(2)^2) * L^2) + 0.2e1 * L * acl2 * tau(1) * tau(3) + acl2^2 * (tau(3)^2)) * cos(q(2))^2 - 0.2e1 * L * tau(2) * sin(q(2)) * ((L * tau(1)) + acl2 * tau(3)) * cos(q(2)) + (L^2 * tau(2)^2));
df2dtau3 = -0.2e1 * sqrt(m2 * acl2^2 + I2) * ((-acl2^5 * taud(2) * tau(3)^8 / 0.2e1 - 0.2e1 * acl2^4 * (L * taud(2) * tau(1) - tau(2) * (L * taud(1) + taud(3) * acl2) / 0.2e1) * tau(3)^7 + acl2^3 * (0.2e1 * L^2 * f^2 * tau(2) + (-0.3e1 * L^2 - acl2^2) * taud(2) * tau(1)^2 + 0.3e1 * (L * taud(3) * acl2 + (L^2 + acl2^2 / 0.2e1) * taud(1)) * tau(2) * tau(1) + L^2 * taud(2) * tau(2)^2) * tau(3)^6 + 0.2e1 * acl2^2 * ((((0.2e1 * L^2 + acl2^2) * tau(2) - acl2^2 * taud(2)) * tau(1) - 0.3e1 / 0.2e1 * acl2 * (L * taud(3) - 0.2e1 / 0.3e1 * acl2 * taud(1)) * tau(2)) * f^2 - taud(2) * (L^2 + 0.2e1 * acl2^2) * tau(1)^3 + 0.3e1 / 0.2e1 * (L * taud(3) * acl2 + taud(1) * (L^2 + 0.7e1 / 0.3e1 * acl2^2)) * tau(2) * tau(1)^2 + L^2 * taud(2) * tau(2)^2 * tau(1) - (L * taud(3) * acl2 + taud(1) * (L^2 - 0.2e1 * acl2^2)) * tau(2)^3 / 0.2e1) * L * tau(3)^5 - acl2 * (0.2e1 * acl2^2 * (taud(2) - 0.5e1 / 0.2e1 * tau(2)) * L^2 * f^4 - 0.4e1 * (((L^2 + 0.17e2 / 0.4e1 * acl2^2) * tau(2) - 0.3e1 * acl2^2 * taud(2)) * L * tau(1)^2 - 0.7e1 / 0.2e1 * acl2 * ((L^2 + acl2^2 / 0.7e1) * taud(3) - 0.9e1 / 0.14e2 * L * acl2 * taud(1)) * tau(2) * tau(1) + L * tau(2)^2 * acl2^2 * (taud(2) + 0.5e1 * tau(2)) / 0.4e1) * L * f^2 + taud(2) * (L^4 + 0.12e2 * L^2 * acl2^2 + acl2^4) * tau(1)^4 - 0.2e1 * tau(2) * ((L^3 * acl2 - L * acl2^3) * taud(3) + taud(1) * (L^4 + 0.12e2 * L^2 * acl2^2 + acl2^4 / 0.2e1)) * tau(1)^3 - 0.2e1 * taud(2) * L^2 * tau(2)^2 * (L^2 + 0.3e1 / 0.2e1 * acl2^2) * tau(1)^2 + 0.2e1 * ((acl2 * L^2 + acl2^3) * taud(3) + L * taud(1) * (L^2 - 0.5e1 * acl2^2)) * L * tau(2)^3 * tau(1) + L^2 * taud(2) * tau(2)^4 * (L^2 - 0.3e1 * acl2^2)) * tau(3)^4 / 0.2e1 - (0.2e1 * (L * (taud(2) - 0.3e1 * tau(2)) * tau(1) + 0.3e1 / 0.2e1 * (L * taud(1) + taud(3) * acl2 / 0.3e1) * tau(2)) * acl2 * L * f^4 + (((-0.11e2 * acl2 * L^2 - acl2^3) * tau(2) + (0.6e1 * acl2 * L^2 + 0.2e1 * acl2^3) * taud(2)) * tau(1)^3 + 0.5e1 * (L^2 + acl2^2) * (L * taud(3) - acl2 * taud(1) / 0.5e1) * tau(2) * tau(1)^2 - 0.7e1 * L^2 * tau(2)^3 * acl2 * tau(1) + ((L^2 + 0.2e1 * acl2^2) * taud(3) + 0.5e1 * L * acl2 * taud(1)) * L * tau(2)^3) * f^2 - 0.3e1 * acl2 * (-0.4e1 / 0.3e1 * taud(2) * (L^2 + acl2^2 / 0.2e1) * tau(1)^5 + 0.3e1 * (-L * taud(3) * acl2 / 0.3e1 + taud(1) * (L^2 + 0.2e1 / 0.9e1 * acl2^2)) * tau(2) * tau(1)^4 + taud(2) * tau(2)^2 * (L^2 - acl2^2 / 0.3e1) * tau(1)^3 + (-0.4e1 / 0.3e1 * L * taud(3) * acl2 + taud(1) * (L^2 + acl2^2 / 0.3e1)) * tau(2)^3 * tau(1)^2 + L^2 * taud(2) * tau(2)^4 * tau(1) - 0.2e1 / 0.3e1 * (L * taud(1) + taud(3) * acl2 / 0.2e1) * L * tau(2)^5)) * acl2 * L * tau(3)^3 - (0.2e1 * L^2 * acl2 * f^6 * tau(2) + 0.3e1 * acl2 * (((-L^2 / 0.2e1 - 0.5e1 / 0.6e1 * acl2^2) * tau(2) + taud(2) * (L^2 + 0.3e1 * acl2^2) / 0.3e1) * tau(1)^2 + 0.5e1 / 0.3e1 * (0.2e1 / 0.5e1 * L * taud(3) * acl2 + taud(1) * (L^2 - acl2^2 / 0.10e2)) * tau(2) * tau(1) + L^2 * tau(2)^2 * (taud(2) + 0.5e1 / 0.6e1 * tau(2))) * f^4 + (0.2e1 * acl2 * ((-0.9e1 / 0.4e1 * L^2 - 0.7e1 / 0.4e1 * acl2^2) * tau(2) + taud(2) * (L^2 + 0.3e1 * acl2^2)) * tau(1)^4 + ((L^3 + 0.6e1 * L * acl2^2) * taud(3) + 0.7e1 / 0.2e1 * acl2 * taud(1) * (L^2 - 0.5e1 / 0.7e1 * acl2^2)) * tau(2) * tau(1)^3 + 0.5e1 / 0.2e1 * acl2 * ((-0.8e1 / 0.5e1 * L^2 - acl2^2) * tau(2) + taud(2) * (L^2 + 0.7e1 / 0.5e1 * acl2^2)) * tau(2)^2 * tau(1)^2 + tau(2)^3 * ((L^3 + 0.3e1 * L * acl2^2) * taud(3) + (0.15e2 / 0.2e1 * acl2 * L^2 - acl2^3) * taud(1)) * tau(1) + 0.9e1 / 0.2e1 * (tau(2) / 0.9e1 + taud(2)) * acl2 * L^2 * tau(2)^4) * f^2 + 0.3e1 / 0.2e1 * acl2 * (0.2e1 / 0.3e1 * taud(2) * (L^2 + 0.3e1 * acl2^2) * tau(1)^6 - 0.5e1 / 0.3e1 * (-0.6e1 / 0.5e1 * L * taud(3) * acl2 + taud(1) * (L^2 + 0.6e1 / 0.5e1 * acl2^2)) * tau(2) * tau(1)^5 - taud(2) * tau(2)^2 * (L^2 - 0.5e1 / 0.3e1 * acl2^2) * tau(1)^4 + 0.8e1 / 0.3e1 * (L * taud(3) - 0.5e1 / 0.8e1 * acl2 * taud(1)) * acl2 * tau(2)^3 * tau(1)^3 - 0.2e1 / 0.3e1 * (L^2 - acl2^2 / 0.2e1) * taud(2) * tau(2)^4 * tau(1)^2 + 0.5e1 / 0.3e1 * (0.2e1 / 0.5e1 * L * taud(3) * acl2 + taud(1) * (L^2 - acl2^2 / 0.5e1)) * tau(2)^5 * tau(1) + L^2 * taud(2) * tau(2)^6)) * L^2 * tau(3)^2 - 0.2e1 * ((((L^2 - acl2^2) * tau(2) + acl2^2 * taud(2)) * tau(1) - L * acl2 * tau(2) * taud(3) / 0.2e1) * f^4 + (0.2e1 * acl2^2 * (taud(2) - tau(2)) * tau(1)^3 + L^2 * tau(2) * taud(1) * tau(1)^2 + (-tau(2) * acl2^2 + taud(2) * (L^2 + acl2^2)) * tau(2)^2 * tau(1) - L * tau(2)^3 * taud(3) * acl2) * f^2 - acl2 * (-0.2e1 * taud(2) * acl2 * tau(1)^5 - tau(2) * (L * taud(3) - 0.2e1 * acl2 * taud(1)) * tau(1)^4 + L * tau(2)^5 * taud(3)) / 0.2e1) * (f^2 + tau(1)^2 + tau(2)^2) * L^3 * tau(3) + (-acl2 * (taud(2) - tau(2)) * f^4 / 0.2e1 + (-acl2 * (taud(2) - 0.3e1 / 0.2e1 * tau(2)) * tau(1)^2 + tau(2) * (L * taud(3) - acl2 * taud(1) / 0.2e1) * tau(1) - tau(2)^2 * acl2 * (taud(2) - tau(2)) / 0.2e1) * f^2 + tau(1) * acl2 * (tau(2) - tau(1)) * (tau(2) + tau(1)) * (-taud(1) * tau(2) + tau(1) * taud(2)) / 0.2e1) * (f^2 + tau(1)^2 + tau(2)^2)^2 * L^4) * cos(q(2))^2 + sin(q(2)) * (acl2^4 * (f^2 + taud(2) * tau(2)) * tau(3)^7 + 0.3e1 * acl2^3 * ((L * tau(1) - taud(3) * acl2 / 0.2e1) * f^2 + (L * taud(2) * tau(1) - 0.2e1 / 0.3e1 * tau(2) * (L * taud(1) + taud(3) * acl2)) * tau(2)) * tau(3)^6 - acl2^2 * (((-0.3e1 * L^2 - 0.2e1 * acl2^2) * tau(1)^2 + (0.5e1 * L * taud(3) * acl2 + 0.2e1 * acl2^2 * taud(1)) * tau(1) + L^2 * tau(2)^2) * f^2 + ((-0.3e1 * L^2 - 0.2e1 * acl2^2) * taud(2) * tau(1)^2 + 0.4e1 * (L * taud(3) * acl2 + taud(1) * (L^2 + 0.3e1 / 0.4e1 * acl2^2)) * tau(2) * tau(1) + L^2 * taud(2) * tau(2)^2) * tau(2)) * tau(3)^5 - acl2 * (0.5e1 / 0.2e1 * acl2^2 * (taud(1) - 0.3e1 / 0.5e1 * tau(1)) * L * f^4 + ((-L^3 - 0.6e1 * L * acl2^2) * tau(1)^3 + ((0.6e1 * acl2 * L^2 + acl2^3 / 0.2e1) * taud(3) + 0.7e1 * L * acl2^2 * taud(1)) * tau(1)^2 + L * tau(2) * (L^2 * tau(2) - 0.3e1 / 0.2e1 * acl2^2 * taud(2)) * tau(1) - acl2 * (L * taud(3) - 0.13e2 / 0.2e1 * acl2 * taud(1)) * L * tau(2)^2) * f^2 + (-taud(2) * (L^2 + 0.6e1 * acl2^2) * tau(1)^3 + 0.2e1 * tau(2) * (L * taud(3) * acl2 + taud(1) * (L^2 + 0.11e2 / 0.2e1 * acl2^2)) * tau(1)^2 + L^2 * taud(2) * tau(2)^2 * tau(1) + 0.4e1 * tau(2)^3 * acl2^2 * taud(1)) * L * tau(2)) * tau(3)^4 + acl2 * (-acl2 * L^2 * f^6 - acl2 * L^2 * (-0.2e1 * tau(1)^2 + 0.6e1 * tau(1) * taud(1) + tau(2) * (taud(2) + 0.4e1 * tau(2))) * f^4 + ((0.6e1 * acl2 * L^2 + acl2^3) * tau(1)^4 + ((-0.3e1 * L^3 - L * acl2^2) * taud(3) + (-0.9e1 * acl2 * L^2 - acl2^3) * taud(1)) * tau(1)^3 + 0.2e1 * acl2 * (taud(2) - tau(2) / 0.2e1) * L^2 * tau(2) * tau(1)^2 + L * tau(2)^2 * ((L^2 + 0.2e1 * acl2^2) * taud(3) - 0.15e2 * L * acl2 * taud(1)) * tau(1) - 0.4e1 * acl2 * L^2 * tau(2)^3 * (taud(2) + 0.3e1 / 0.4e1 * tau(2))) * f^2 - 0.3e1 * acl2 * tau(2) * (-0.2e1 * taud(2) * (L^2 + acl2^2 / 0.6e1) * tau(1)^4 + 0.13e2 / 0.3e1 * tau(2) * (-0.2e1 / 0.13e2 * L * taud(3) * acl2 + taud(1) * (L^2 + acl2^2 / 0.13e2)) * tau(1)^3 + L^2 * taud(2) * tau(2)^2 * tau(1)^2 / 0.3e1 + 0.3e1 * (L * taud(1) - 0.2e1 / 0.9e1 * taud(3) * acl2) * L * tau(2)^3 * tau(1) + L^2 * taud(2) * tau(2)^4)) * tau(3)^3 + ((-0.4e1 * L^2 * acl2 * tau(1) + L * acl2^2 * taud(3)) * f^6 - 0.4e1 * acl2 * ((L^2 / 0.4e1 - 0.5e1 / 0.4e1 * acl2^2) * tau(1)^3 + (-L * taud(3) * acl2 / 0.2e1 + 0.9e1 / 0.4e1 * taud(1) * (L^2 + 0.5e1 / 0.9e1 * acl2^2)) * tau(1)^2 + L^2 * tau(2) * (taud(2) + 0.9e1 / 0.4e1 * tau(2)) * tau(1) - L * tau(2)^2 * (L * taud(1) + 0.6e1 * taud(3) * acl2) / 0.4e1) * f^4 + ((0.4e1 * acl2 * L^2 + 0.6e1 * acl2^3) * tau(1)^5 + (-L^3 * taud(3) + (-0.10e2 * acl2 * L^2 - 0.6e1 * acl2^3) * taud(1)) * tau(1)^4 - acl2 * ((0.2e1 * L^2 - 0.4e1 * acl2^2) * tau(2) + taud(2) * (L^2 - 0.5e1 * acl2^2)) * tau(2) * tau(1)^3 - 0.17e2 * (-0.15e2 / 0.17e2 * L * taud(3) * acl2 + taud(1) * (L^2 + 0.9e1 / 0.17e2 * acl2^2)) * acl2 * tau(2)^2 * tau(1)^2 - 0.9e1 * acl2 * (taud(2) + 0.2e1 / 0.3e1 * tau(2)) * L^2 * tau(2)^3 * tau(1) + ((L^2 + 0.9e1 * acl2^2) * taud(3) + L * acl2 * taud(1)) * L * tau(2)^4) * f^2 - 0.6e1 * acl2 * tau(2) * (taud(2) * (-0.2e1 / 0.3e1 * L^2 - acl2^2) * tau(1)^5 + 0.5e1 / 0.3e1 * (-0.4e1 / 0.5e1 * L * taud(3) * acl2 + taud(1) * (L^2 + 0.3e1 / 0.5e1 * acl2^2)) * tau(2) * tau(1)^4 + taud(2) * tau(2)^2 * (L^2 - 0.2e1 * acl2^2) * tau(1)^3 / 0.3e1 + 0.5e1 / 0.3e1 * tau(2)^3 * (-0.6e1 / 0.5e1 * L * taud(3) * acl2 + taud(1) * (L^2 + 0.2e1 / 0.5e1 * acl2^2)) * tau(1)^2 + L^2 * taud(2) * tau(2)^4 * tau(1) - 0.2e1 / 0.3e1 * L * tau(2)^5 * taud(3) * acl2)) * L * tau(3)^2 / 0.2e1 + (((-L^2 + 0.2e1 * acl2^2) * tau(1)^2 + (L * taud(3) * acl2 - 0.2e1 * acl2^2 * taud(1)) * tau(1) + L^2 * tau(2)^2) * f^4 + (0.3e1 * acl2^2 * tau(1)^4 + (L * taud(3) * acl2 - taud(1) * (L^2 + 0.3e1 * acl2^2)) * tau(1)^3 - tau(2) * (-tau(2) * acl2^2 + taud(2) * (L^2 - 0.2e1 * acl2^2)) * tau(1)^2 + (0.3e1 * L * taud(3) * acl2 + (L^2 - 0.3e1 * acl2^2) * taud(1)) * tau(2)^2 * tau(1) + L^2 * taud(2) * tau(2)^3) * f^2 + 0.2e1 * tau(1) * acl2 * (0.3e1 / 0.2e1 * taud(2) * acl2 * tau(1)^3 + tau(2) * (L * taud(3) - 0.3e1 / 0.2e1 * acl2 * taud(1)) * tau(1)^2 + taud(2) * tau(2)^2 * acl2 * tau(1) / 0.2e1 + tau(2)^3 * (L * taud(3) - acl2 * taud(1) / 0.2e1)) * tau(2)) * (f^2 + tau(1)^2 + tau(2)^2) * L^2 * tau(3) - (f^2 + tau(1)^2 + tau(2)^2)^2 * L^3 * (acl2 * (taud(1) - tau(1)) * f^4 + (-0.2e1 * acl2 * tau(1)^3 + (-L * taud(3) + 0.2e1 * acl2 * taud(1)) * tau(1)^2 - tau(1) * taud(2) * acl2 * tau(2) + tau(2)^2 * (L * taud(3) + acl2 * taud(1))) * f^2 - 0.2e1 * tau(2) * acl2 * tau(1)^2 * (-taud(1) * tau(2) + tau(1) * taud(2))) / 0.2e1) * L * cos(q(2)) + (-acl2^3 * (f^2 + taud(2) * tau(2)) * tau(3)^6 / 0.2e1 - ((L * tau(1) - taud(3) * acl2) * f^2 + (L * taud(2) * tau(1) - tau(2) * (L * taud(1) + taud(3) * acl2)) * tau(2)) * acl2^2 * tau(3)^5 + acl2 * (((-L^2 - 0.2e1 * acl2^2) * tau(1)^2 + (0.5e1 * L * taud(3) * acl2 + 0.3e1 * acl2^2 * taud(1)) * tau(1) + L^2 * tau(2)^2) * f^2 + (-taud(2) * (L^2 + 0.2e1 * acl2^2) * tau(1)^2 + 0.2e1 * tau(2) * (L * taud(3) * acl2 + taud(1) * (L^2 + 0.3e1 / 0.2e1 * acl2^2)) * tau(1) + L^2 * taud(2) * tau(2)^2) * tau(2)) * tau(3)^4 / 0.2e1 + 0.2e1 * acl2 * (acl2 * taud(1) * f^4 + (-acl2 * tau(1)^3 + (L * taud(3) + 0.2e1 * acl2 * taud(1)) * tau(1)^2 + 0.2e1 * tau(2)^2 * acl2 * taud(1)) * f^2 - tau(2) * acl2 * (-0.2e1 * tau(1)^2 * tau(2) * taud(1) - tau(2)^3 * taud(1) + taud(2) * tau(1)^3)) * L * tau(3)^3 + (0.3e1 / 0.2e1 * acl2 * L^2 * f^6 + 0.3e1 / 0.2e1 * acl2 * (0.2e1 / 0.3e1 * tau(1)^2 * L + (0.2e1 * L * taud(1) - 0.2e1 / 0.3e1 * taud(3) * acl2) * tau(1) + L * tau(2) * (taud(2) + 0.2e1 * tau(2))) * L * f^4 + ((-acl2^3 / 0.2e1 - acl2 * L^2) * tau(1)^4 + ((-L * acl2^2 / 0.2e1 + L^3 / 0.2e1) * taud(3) + 0.7e1 / 0.2e1 * acl2 * (L^2 + acl2^2 / 0.7e1) * taud(1)) * tau(1)^3 + L^2 * tau(2) * acl2 * (tau(2) / 0.2e1 + taud(2)) * tau(1)^2 + (taud(3) * (L^2 - 0.4e1 * acl2^2) + 0.11e2 * L * acl2 * taud(1)) * L * tau(2)^2 * tau(1) / 0.2e1 + 0.3e1 * acl2 * (tau(2) / 0.2e1 + taud(2)) * L^2 * tau(2)^3) * f^2 + 0.3e1 / 0.2e1 * acl2 * (-0.2e1 / 0.3e1 * taud(2) * (L^2 + acl2^2 / 0.2e1) * tau(1)^4 + 0.5e1 / 0.3e1 * (-0.2e1 / 0.5e1 * L * taud(3) * acl2 + taud(1) * (L^2 + acl2^2 / 0.5e1)) * tau(2) * tau(1)^3 + L^2 * taud(2) * tau(2)^2 * tau(1)^2 / 0.3e1 + 0.5e1 / 0.3e1 * (L * taud(1) - 0.2e1 / 0.5e1 * taud(3) * acl2) * L * tau(2)^3 * tau(1) + L^2 * taud(2) * tau(2)^4) * tau(2)) * tau(3)^2 + (f^2 + tau(1)^2 + tau(2)^2) * L * ((L^2 * tau(1) - L * taud(3) * acl2) * f^4 + (-acl2^2 * tau(1)^3 + (-L * taud(3) * acl2 + taud(1) * (L^2 + acl2^2)) * tau(1)^2 + L^2 * taud(2) * tau(2) * tau(1) - 0.2e1 * L * tau(2)^2 * taud(3) * acl2) * f^2 - acl2 * tau(2) * (taud(2) * acl2 * tau(1)^3 + tau(2) * (L * taud(3) - acl2 * taud(1)) * tau(1)^2 + L * tau(2)^3 * taud(3))) * tau(3) - tau(1) * (f^2 + tau(1)^2 + tau(2)^2)^2 * L^2 * ((L * taud(3) - acl2 * taud(1) + acl2 * tau(1)) * f^2 + tau(2) * acl2 * (-taud(1) * tau(2) + tau(1) * taud(2))) / 0.2e1) * L^2 * tau(2)) * L / (acl2^2 * tau(3)^4 + 0.2e1 * L * acl2 * tau(1) * tau(3)^3 + (L^2 * tau(2)^2 + tau(1)^2 * (L^2 + acl2^2)) * tau(3)^2 + 0.2e1 * L * tau(1) * acl2 * (f^2 + tau(1)^2 + tau(2)^2) * tau(3) + L^2 * (f^2 + tau(1)^2 + tau(2)^2)^2)^2 / ((-L^2 * tau(1)^2 + L^2 * tau(2)^2 - 0.2e1 * L * acl2 * tau(1) * tau(3) - acl2^2 * tau(3)^2) * cos(q(2))^2 + 0.2e1 * L * tau(2) * sin(q(2)) * (L * tau(1) + acl2 * tau(3)) * cos(q(2)) - L^2 * tau(2)^2);
dfdtau = [ df1dtau1, df1dtau2, df1dtau3;
           df2dtau1, df2dtau2, df2dtau3 ];
%% C3 = (\pd{\theta}{\bar{q}} + \pd{\theta}{\bar{\tau}} \bar{\Delta})
%       \bar{T}^{-T} \bar{p}
%     = ...
%     = (\pd{T^T \Delta_{\tau}^+ (\tau - \taud)}{q}
%       + \pd{T^T \Delta_{\tau}^+ (\tau - \taud)}{\tau} \Delta_{\tau}) \dot{q}
C3 = (dfdq + dfdtau*Delta_tau)*qdot

%% C4 = C \bar{p}
C4 = C*pbar

%% C5 = \bar{T}^{-1} \bar{\Delta}^T \bar{\tau}
C5 = invT*Delta_tau'*ferr

u = inv( Gbar )*( C1 + C2 - C3 - C4 - C5 );
